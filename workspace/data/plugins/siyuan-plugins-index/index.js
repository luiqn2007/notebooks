"use strict";var Xi=Object.defineProperty;var Zi=(e,t,n)=>t in e?Xi(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var $=(e,t,n)=>(Zi(e,typeof t!="symbol"?t+"":t,n),n);const me=require("siyuan");var es=Object.defineProperty,ts=(e,t,n)=>t in e?es(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ie=(e,t,n)=>(ts(e,typeof t!="symbol"?t+"":t,n),n);const ns=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,os=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,is=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function ss(e,t){if(e==="__proto__"||e==="constructor"&&t&&typeof t=="object"&&"prototype"in t){as(e);return}return t}function as(e){console.warn(`[destr] Dropping "${e}" key to prevent prototype pollution.`)}function rs(e,t={}){if(typeof e!="string")return e;const n=e.trim();if(e[0]==='"'&&e.at(-1)==='"'&&!e.includes("\\"))return n.slice(1,-1);if(n.length<=9){const o=n.toLowerCase();if(o==="true")return!0;if(o==="false")return!1;if(o==="undefined")return;if(o==="null")return null;if(o==="nan")return Number.NaN;if(o==="infinity")return Number.POSITIVE_INFINITY;if(o==="-infinity")return Number.NEGATIVE_INFINITY}if(!is.test(e)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return e}try{if(ns.test(e)||os.test(e)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(e,ss)}return JSON.parse(e)}catch(o){if(t.strict)throw o;return e}}const ls=/#/g,cs=/&/g,us=/=/g,$n=/\+/g,ps=/%5e/gi,fs=/%60/gi,ds=/%7c/gi,hs=/%20/gi;function ms(e){return encodeURI(""+e).replace(ds,"|")}function Rn(e){return ms(typeof e=="string"?e:JSON.stringify(e)).replace($n,"%2B").replace(hs,"+").replace(ls,"%23").replace(cs,"%26").replace(fs,"`").replace(ps,"^")}function On(e){return Rn(e).replace(us,"%3D")}function li(e=""){try{return decodeURIComponent(""+e)}catch{return""+e}}function gs(e){return li(e.replace($n," "))}function bs(e){return li(e.replace($n," "))}function ys(e=""){const t={};e[0]==="?"&&(e=e.slice(1));for(const n of e.split("&")){const o=n.match(/([^=]+)=?(.*)/)||[];if(o.length<2)continue;const i=gs(o[1]);if(i==="__proto__"||i==="constructor")continue;const s=bs(o[2]||"");t[i]===void 0?t[i]=s:Array.isArray(t[i])?t[i].push(s):t[i]=[t[i],s]}return t}function _s(e,t){return(typeof t=="number"||typeof t=="boolean")&&(t=String(t)),t?Array.isArray(t)?t.map(n=>`${On(e)}=${Rn(n)}`).join("&"):`${On(e)}=${Rn(t)}`:On(e)}function ws(e){return Object.keys(e).filter(t=>e[t]!==void 0).map(t=>_s(t,e[t])).filter(Boolean).join("&")}const ks=/^[\s\w\0+.-]{2,}:([/\\]{1,2})/,vs=/^[\s\w\0+.-]{2,}:([/\\]{2})?/,Ts=/^([/\\]\s*){2,}[^/\\]/;function ci(e,t={}){return typeof t=="boolean"&&(t={acceptRelative:t}),t.strict?ks.test(e):vs.test(e)||(t.acceptRelative?Ts.test(e):!1)}const Ss=/\/$|\/\?|\/#/;function Nn(e="",t){return t?Ss.test(e):e.endsWith("/")}function Os(e="",t){if(!t)return(Nn(e)?e.slice(0,-1):e)||"/";if(!Nn(e,!0))return e||"/";let n=e,o="";const i=e.indexOf("#");i>=0&&(n=e.slice(0,i),o=e.slice(i));const[s,...a]=n.split("?");return(s.slice(0,-1)||"/")+(a.length>0?`?${a.join("?")}`:"")+o}function Es(e="",t){if(!t)return e.endsWith("/")?e:e+"/";if(Nn(e,!0))return e||"/";let n=e,o="";const i=e.indexOf("#");if(i>=0&&(n=e.slice(0,i),o=e.slice(i),!n))return o;const[s,...a]=n.split("?");return s+"/"+(a.length>0?`?${a.join("?")}`:"")+o}function As(e,t){if(Bs(t)||ci(e))return e;const n=Os(t);return e.startsWith(n)?e:Rs(n,e)}function Ps(e,t){const n=ui(e),o={...ys(n.search),...t};return n.search=ws(o),Ns(n)}function Bs(e){return!e||e==="/"}function Cs(e){return e&&e!=="/"}const xs=/^\.?\//;function Rs(e,...t){let n=e||"";for(const o of t.filter(i=>Cs(i)))if(n){const i=o.replace(xs,"");n=Es(n)+i}else n=o;return n}function ui(e="",t){const n=e.match(/^[\s\0]*(blob:|data:|javascript:|vbscript:)(.*)/i);if(n){const[,g,w=""]=n;return{protocol:g.toLowerCase(),pathname:w,href:g+w,auth:"",host:"",search:"",hash:""}}if(!ci(e,{acceptRelative:!0}))return t?ui(t+e):Eo(e);const[,o="",i,s=""]=e.replace(/\\/g,"/").match(/^[\s\0]*([\w+.-]{2,}:)?\/\/([^/@]+@)?(.*)/)||[],[,a="",l=""]=s.match(/([^#/?]*)(.*)?/)||[],{pathname:c,search:u,hash:r}=Eo(l.replace(/\/(?=[A-Za-z]:)/,""));return{protocol:o.toLowerCase(),auth:i?i.slice(0,Math.max(0,i.length-1)):"",host:a,pathname:c,search:u,hash:r}}function Eo(e=""){const[t="",n="",o=""]=(e.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:t,search:n,hash:o}}function Ns(e){const t=e.pathname||"",n=e.search?(e.search.startsWith("?")?"":"?")+e.search:"",o=e.hash||"",i=e.auth?e.auth+"@":"",s=e.host||"";return(e.protocol?e.protocol+"//":"")+i+s+t+n+o}class Ds extends Error{constructor(t,n){super(t,n),this.name="FetchError",n!=null&&n.cause&&!this.cause&&(this.cause=n.cause)}}function qs(e){var t,n,o,i,s;const a=((t=e.error)==null?void 0:t.message)||((n=e.error)==null?void 0:n.toString())||"",l=((o=e.request)==null?void 0:o.method)||((i=e.options)==null?void 0:i.method)||"GET",c=((s=e.request)==null?void 0:s.url)||String(e.request)||"/",u=`[${l}] ${JSON.stringify(c)}`,r=e.response?`${e.response.status} ${e.response.statusText}`:"<no response>",g=`${u}: ${r}${a?` ${a}`:""}`,w=new Ds(g,e.error?{cause:e.error}:void 0);for(const m of["request","options","response"])Object.defineProperty(w,m,{get(){return e[m]}});for(const[m,_]of[["data","_data"],["status","status"],["statusCode","status"],["statusText","statusText"],["statusMessage","statusText"]])Object.defineProperty(w,m,{get(){return e.response&&e.response[_]}});return w}const Is=new Set(Object.freeze(["PATCH","POST","PUT","DELETE"]));function Ao(e="GET"){return Is.has(e.toUpperCase())}function Ls(e){if(e===void 0)return!1;const t=typeof e;return t==="string"||t==="number"||t==="boolean"||t===null?!0:t!=="object"?!1:Array.isArray(e)?!0:e.buffer?!1:e.constructor&&e.constructor.name==="Object"||typeof e.toJSON=="function"}const js=new Set(["image/svg","application/xml","application/xhtml","application/html"]),Fs=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function Us(e=""){if(!e)return"json";const t=e.split(";").shift()||"";return Fs.test(t)?"json":js.has(t)||t.startsWith("text/")?"text":"blob"}function Ms(e,t,n=globalThis.Headers){const o={...t,...e};if(t!=null&&t.params&&e!=null&&e.params&&(o.params={...t==null?void 0:t.params,...e==null?void 0:e.params}),t!=null&&t.query&&e!=null&&e.query&&(o.query={...t==null?void 0:t.query,...e==null?void 0:e.query}),t!=null&&t.headers&&e!=null&&e.headers){o.headers=new n((t==null?void 0:t.headers)||{});for(const[i,s]of new n((e==null?void 0:e.headers)||{}))o.headers.set(i,s)}return o}const $s=new Set([408,409,425,429,500,502,503,504]),Hs=new Set([101,204,205,304]);function pi(e={}){const{fetch:t=globalThis.fetch,Headers:n=globalThis.Headers,AbortController:o=globalThis.AbortController}=e;async function i(l){const c=l.error&&l.error.name==="AbortError"&&!l.options.timeout||!1;if(l.options.retry!==!1&&!c){let r;typeof l.options.retry=="number"?r=l.options.retry:r=Ao(l.options.method)?0:1;const g=l.response&&l.response.status||500;if(r>0&&(Array.isArray(l.options.retryStatusCodes)?l.options.retryStatusCodes.includes(g):$s.has(g))){const w=l.options.retryDelay||0;return w>0&&await new Promise(m=>setTimeout(m,w)),s(l.request,{...l.options,retry:r-1,timeout:l.options.timeout})}}const u=qs(l);throw Error.captureStackTrace&&Error.captureStackTrace(u,s),u}const s=async function(l,c={}){var u;const r={request:l,options:Ms(c,e.defaults,n),response:void 0,error:void 0};if(r.options.method=(u=r.options.method)==null?void 0:u.toUpperCase(),r.options.onRequest&&await r.options.onRequest(r),typeof r.request=="string"&&(r.options.baseURL&&(r.request=As(r.request,r.options.baseURL)),(r.options.query||r.options.params)&&(r.request=Ps(r.request,{...r.options.params,...r.options.query}))),r.options.body&&Ao(r.options.method)&&(Ls(r.options.body)?(r.options.body=typeof r.options.body=="string"?r.options.body:JSON.stringify(r.options.body),r.options.headers=new n(r.options.headers||{}),r.options.headers.has("content-type")||r.options.headers.set("content-type","application/json"),r.options.headers.has("accept")||r.options.headers.set("accept","application/json")):("pipeTo"in r.options.body&&typeof r.options.body.pipeTo=="function"||typeof r.options.body.pipe=="function")&&("duplex"in r.options||(r.options.duplex="half"))),!r.options.signal&&r.options.timeout){const g=new o;setTimeout(()=>g.abort(),r.options.timeout),r.options.signal=g.signal}try{r.response=await t(r.request,r.options)}catch(g){return r.error=g,r.options.onRequestError&&await r.options.onRequestError(r),await i(r)}if(r.response.body&&!Hs.has(r.response.status)&&r.options.method!=="HEAD"){const g=(r.options.parseResponse?"json":r.options.responseType)||Us(r.response.headers.get("content-type")||"");switch(g){case"json":{const w=await r.response.text(),m=r.options.parseResponse||rs;r.response._data=m(w);break}case"stream":{r.response._data=r.response.body;break}default:r.response._data=await r.response[g]()}}return r.options.onResponse&&await r.options.onResponse(r),!r.options.ignoreResponseError&&r.response.status>=400&&r.response.status<600?(r.options.onResponseError&&await r.options.onResponseError(r),await i(r)):r.response},a=async function(l,c){return(await s(l,c))._data};return a.raw=s,a.native=(...l)=>t(...l),a.create=(l={})=>pi({...e,defaults:{...e.defaults,...l}}),a}const Hn=function(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}(),Vs=Hn.fetch||(()=>Promise.reject(new Error("[ofetch] global.fetch is not supported!"))),zs=Hn.Headers,Ks=Hn.AbortController,Ws=pi({fetch:Vs,Headers:zs,AbortController:Ks});class Js extends Error{constructor(t){super(t.statusText),Ie(this,"status"),this.response=t,this.status=t.status}}class Po extends Error{constructor(t,n){super(t.msg),Ie(this,"code"),this.body=t,this.response=n,this.code=t.code}}function Ce(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function Bo(e,t){for(var n="",o=0,i=-1,s=0,a,l=0;l<=e.length;++l){if(l<e.length)a=e.charCodeAt(l);else{if(a===47)break;a=47}if(a===47){if(!(i===l-1||s===1))if(i!==l-1&&s===2){if(n.length<2||o!==2||n.charCodeAt(n.length-1)!==46||n.charCodeAt(n.length-2)!==46){if(n.length>2){var c=n.lastIndexOf("/");if(c!==n.length-1){c===-1?(n="",o=0):(n=n.slice(0,c),o=n.length-1-n.lastIndexOf("/")),i=l,s=0;continue}}else if(n.length===2||n.length===1){n="",o=0,i=l,s=0;continue}}t&&(n.length>0?n+="/..":n="..",o=2)}else n.length>0?n+="/"+e.slice(i+1,l):n=e.slice(i+1,l),o=l-i-1;i=l,s=0}else a===46&&s!==-1?++s:s=-1}return n}function Gs(e,t){var n=t.dir||t.root,o=t.base||(t.name||"")+(t.ext||"");return n?n===t.root?n+o:n+e+o:o}var xt={resolve:function(){for(var e="",t=!1,n,o=arguments.length-1;o>=-1&&!t;o--){var i;o>=0?i=arguments[o]:(n===void 0&&(n=process.cwd()),i=n),Ce(i),i.length!==0&&(e=i+"/"+e,t=i.charCodeAt(0)===47)}return e=Bo(e,!t),t?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(Ce(e),e.length===0)return".";var t=e.charCodeAt(0)===47,n=e.charCodeAt(e.length-1)===47;return e=Bo(e,!t),e.length===0&&!t&&(e="."),e.length>0&&n&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return Ce(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,t=0;t<arguments.length;++t){var n=arguments[t];Ce(n),n.length>0&&(e===void 0?e=n:e+="/"+n)}return e===void 0?".":xt.normalize(e)},relative:function(e,t){if(Ce(e),Ce(t),e===t||(e=xt.resolve(e),t=xt.resolve(t),e===t))return"";for(var n=1;n<e.length&&e.charCodeAt(n)===47;++n);for(var o=e.length,i=o-n,s=1;s<t.length&&t.charCodeAt(s)===47;++s);for(var a=t.length,l=a-s,c=i<l?i:l,u=-1,r=0;r<=c;++r){if(r===c){if(l>c){if(t.charCodeAt(s+r)===47)return t.slice(s+r+1);if(r===0)return t.slice(s+r)}else i>c&&(e.charCodeAt(n+r)===47?u=r:r===0&&(u=0));break}var g=e.charCodeAt(n+r),w=t.charCodeAt(s+r);if(g!==w)break;g===47&&(u=r)}var m="";for(r=n+u+1;r<=o;++r)(r===o||e.charCodeAt(r)===47)&&(m.length===0?m+="..":m+="/..");return m.length>0?m+t.slice(s+u):(s+=u,t.charCodeAt(s)===47&&++s,t.slice(s))},_makeLong:function(e){return e},dirname:function(e){if(Ce(e),e.length===0)return".";for(var t=e.charCodeAt(0),n=t===47,o=-1,i=!0,s=e.length-1;s>=1;--s)if(t=e.charCodeAt(s),t===47){if(!i){o=s;break}}else i=!1;return o===-1?n?"/":".":n&&o===1?"//":e.slice(0,o)},basename:function(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');Ce(e);var n=0,o=-1,i=!0,s;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var a=t.length-1,l=-1;for(s=e.length-1;s>=0;--s){var c=e.charCodeAt(s);if(c===47){if(!i){n=s+1;break}}else l===-1&&(i=!1,l=s+1),a>=0&&(c===t.charCodeAt(a)?--a===-1&&(o=s):(a=-1,o=l))}return n===o?o=l:o===-1&&(o=e.length),e.slice(n,o)}else{for(s=e.length-1;s>=0;--s)if(e.charCodeAt(s)===47){if(!i){n=s+1;break}}else o===-1&&(i=!1,o=s+1);return o===-1?"":e.slice(n,o)}},extname:function(e){Ce(e);for(var t=-1,n=0,o=-1,i=!0,s=0,a=e.length-1;a>=0;--a){var l=e.charCodeAt(a);if(l===47){if(!i){n=a+1;break}continue}o===-1&&(i=!1,o=a+1),l===46?t===-1?t=a:s!==1&&(s=1):t!==-1&&(s=-1)}return t===-1||o===-1||s===0||s===1&&t===o-1&&t===n+1?"":e.slice(t,o)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return Gs("/",e)},parse:function(e){Ce(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;var n=e.charCodeAt(0),o=n===47,i;o?(t.root="/",i=1):i=0;for(var s=-1,a=0,l=-1,c=!0,u=e.length-1,r=0;u>=i;--u){if(n=e.charCodeAt(u),n===47){if(!c){a=u+1;break}continue}l===-1&&(c=!1,l=u+1),n===46?s===-1?s=u:r!==1&&(r=1):s!==-1&&(r=-1)}return s===-1||l===-1||r===0||r===1&&s===l-1&&s===a+1?l!==-1&&(a===0&&o?t.base=t.name=e.slice(1,l):t.base=t.name=e.slice(a,l)):(a===0&&o?(t.name=e.slice(1,s),t.base=e.slice(1,l)):(t.name=e.slice(a,s),t.base=e.slice(a,l)),t.ext=e.slice(s,l)),a>0?t.dir=e.slice(0,a-1):o&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};xt.posix=xt;function fi(e,t){return function(){return e.apply(t,arguments)}}const{toString:Qs}=Object.prototype,{getPrototypeOf:Vn}=Object,cn=(e=>t=>{const n=Qs.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Re=e=>(e=e.toLowerCase(),t=>cn(t)===e),un=e=>t=>typeof t===e,{isArray:St}=Array,Nt=un("undefined");function Ys(e){return e!==null&&!Nt(e)&&e.constructor!==null&&!Nt(e.constructor)&&ge(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const di=Re("ArrayBuffer");function Xs(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&di(e.buffer),t}const Zs=un("string"),ge=un("function"),hi=un("number"),pn=e=>e!==null&&typeof e=="object",ea=e=>e===!0||e===!1,tn=e=>{if(cn(e)!=="object")return!1;const t=Vn(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},ta=Re("Date"),na=Re("File"),oa=Re("Blob"),ia=Re("FileList"),sa=e=>pn(e)&&ge(e.pipe),aa=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||ge(e.append)&&((t=cn(e))==="formdata"||t==="object"&&ge(e.toString)&&e.toString()==="[object FormData]"))},ra=Re("URLSearchParams"),la=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function jt(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let o,i;if(typeof e!="object"&&(e=[e]),St(e))for(o=0,i=e.length;o<i;o++)t.call(null,e[o],o,e);else{const s=n?Object.getOwnPropertyNames(e):Object.keys(e),a=s.length;let l;for(o=0;o<a;o++)l=s[o],t.call(null,e[l],l,e)}}function mi(e,t){t=t.toLowerCase();const n=Object.keys(e);let o=n.length,i;for(;o-- >0;)if(i=n[o],t===i.toLowerCase())return i;return null}const gi=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,bi=e=>!Nt(e)&&e!==gi;function Dn(){const{caseless:e}=bi(this)&&this||{},t={},n=(o,i)=>{const s=e&&mi(t,i)||i;tn(t[s])&&tn(o)?t[s]=Dn(t[s],o):tn(o)?t[s]=Dn({},o):St(o)?t[s]=o.slice():t[s]=o};for(let o=0,i=arguments.length;o<i;o++)arguments[o]&&jt(arguments[o],n);return t}const ca=(e,t,n,{allOwnKeys:o}={})=>(jt(t,(i,s)=>{n&&ge(i)?e[s]=fi(i,n):e[s]=i},{allOwnKeys:o}),e),ua=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),pa=(e,t,n,o)=>{e.prototype=Object.create(t.prototype,o),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},fa=(e,t,n,o)=>{let i,s,a;const l={};if(t=t||{},e==null)return t;do{for(i=Object.getOwnPropertyNames(e),s=i.length;s-- >0;)a=i[s],(!o||o(a,e,t))&&!l[a]&&(t[a]=e[a],l[a]=!0);e=n!==!1&&Vn(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},da=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const o=e.indexOf(t,n);return o!==-1&&o===n},ha=e=>{if(!e)return null;if(St(e))return e;let t=e.length;if(!hi(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},ma=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Vn(Uint8Array)),ga=(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let o;for(;(o=n.next())&&!o.done;){const i=o.value;t.call(e,i[0],i[1])}},ba=(e,t)=>{let n;const o=[];for(;(n=e.exec(t))!==null;)o.push(n);return o},ya=Re("HTMLFormElement"),_a=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,n,o){return n.toUpperCase()+o}),Co=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),wa=Re("RegExp"),yi=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),o={};jt(n,(i,s)=>{let a;(a=t(i,s,e))!==!1&&(o[s]=a||i)}),Object.defineProperties(e,o)},ka=e=>{yi(e,(t,n)=>{if(ge(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const o=e[n];if(ge(o)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},va=(e,t)=>{const n={},o=i=>{i.forEach(s=>{n[s]=!0})};return St(e)?o(e):o(String(e).split(t)),n},Ta=()=>{},Sa=(e,t)=>(e=+e,Number.isFinite(e)?e:t),En="abcdefghijklmnopqrstuvwxyz",xo="0123456789",_i={DIGIT:xo,ALPHA:En,ALPHA_DIGIT:En+En.toUpperCase()+xo},Oa=(e=16,t=_i.ALPHA_DIGIT)=>{let n="";const{length:o}=t;for(;e--;)n+=t[Math.random()*o|0];return n};function Ea(e){return!!(e&&ge(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const Aa=e=>{const t=new Array(10),n=(o,i)=>{if(pn(o)){if(t.indexOf(o)>=0)return;if(!("toJSON"in o)){t[i]=o;const s=St(o)?[]:{};return jt(o,(a,l)=>{const c=n(a,i+1);!Nt(c)&&(s[l]=c)}),t[i]=void 0,s}}return o};return n(e,0)},Pa=Re("AsyncFunction"),Ba=e=>e&&(pn(e)||ge(e))&&ge(e.then)&&ge(e.catch),h={isArray:St,isArrayBuffer:di,isBuffer:Ys,isFormData:aa,isArrayBufferView:Xs,isString:Zs,isNumber:hi,isBoolean:ea,isObject:pn,isPlainObject:tn,isUndefined:Nt,isDate:ta,isFile:na,isBlob:oa,isRegExp:wa,isFunction:ge,isStream:sa,isURLSearchParams:ra,isTypedArray:ma,isFileList:ia,forEach:jt,merge:Dn,extend:ca,trim:la,stripBOM:ua,inherits:pa,toFlatObject:fa,kindOf:cn,kindOfTest:Re,endsWith:da,toArray:ha,forEachEntry:ga,matchAll:ba,isHTMLForm:ya,hasOwnProperty:Co,hasOwnProp:Co,reduceDescriptors:yi,freezeMethods:ka,toObjectSet:va,toCamelCase:_a,noop:Ta,toFiniteNumber:Sa,findKey:mi,global:gi,isContextDefined:bi,ALPHABET:_i,generateString:Oa,isSpecCompliantForm:Ea,toJSONObject:Aa,isAsyncFn:Pa,isThenable:Ba};function B(e,t,n,o,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),o&&(this.request=o),i&&(this.response=i)}h.inherits(B,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:h.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const wi=B.prototype,ki={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{ki[e]={value:e}});Object.defineProperties(B,ki);Object.defineProperty(wi,"isAxiosError",{value:!0});B.from=(e,t,n,o,i,s)=>{const a=Object.create(wi);return h.toFlatObject(e,a,function(l){return l!==Error.prototype},l=>l!=="isAxiosError"),B.call(a,e.message,t,n,o,i),a.cause=e,a.name=e.name,s&&Object.assign(a,s),a};const Ca=null;function qn(e){return h.isPlainObject(e)||h.isArray(e)}function vi(e){return h.endsWith(e,"[]")?e.slice(0,-2):e}function Ro(e,t,n){return e?e.concat(t).map(function(o,i){return o=vi(o),!n&&i?"["+o+"]":o}).join(n?".":""):t}function xa(e){return h.isArray(e)&&!e.some(qn)}const Ra=h.toFlatObject(h,{},null,function(e){return/^is[A-Z]/.test(e)});function fn(e,t,n){if(!h.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=h.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,_){return!h.isUndefined(_[m])});const o=n.metaTokens,i=n.visitor||u,s=n.dots,a=n.indexes,l=(n.Blob||typeof Blob<"u"&&Blob)&&h.isSpecCompliantForm(t);if(!h.isFunction(i))throw new TypeError("visitor must be a function");function c(m){if(m===null)return"";if(h.isDate(m))return m.toISOString();if(!l&&h.isBlob(m))throw new B("Blob is not supported. Use a Buffer instead.");return h.isArrayBuffer(m)||h.isTypedArray(m)?l&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function u(m,_,E){let D=m;if(m&&!E&&typeof m=="object"){if(h.endsWith(_,"{}"))_=o?_:_.slice(0,-2),m=JSON.stringify(m);else if(h.isArray(m)&&xa(m)||(h.isFileList(m)||h.endsWith(_,"[]"))&&(D=h.toArray(m)))return _=vi(_),D.forEach(function(S,X){!(h.isUndefined(S)||S===null)&&t.append(a===!0?Ro([_],X,s):a===null?_:_+"[]",c(S))}),!1}return qn(m)?!0:(t.append(Ro(E,_,s),c(m)),!1)}const r=[],g=Object.assign(Ra,{defaultVisitor:u,convertValue:c,isVisitable:qn});function w(m,_){if(!h.isUndefined(m)){if(r.indexOf(m)!==-1)throw Error("Circular reference detected in "+_.join("."));r.push(m),h.forEach(m,function(E,D){(!(h.isUndefined(E)||E===null)&&i.call(t,E,h.isString(D)?D.trim():D,_,g))===!0&&w(E,_?_.concat(D):[D])}),r.pop()}}if(!h.isObject(e))throw new TypeError("data must be an object");return w(e),t}function No(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function zn(e,t){this._pairs=[],e&&fn(e,this,t)}const Ti=zn.prototype;Ti.append=function(e,t){this._pairs.push([e,t])};Ti.toString=function(e){const t=e?function(n){return e.call(this,n,No)}:No;return this._pairs.map(function(n){return t(n[0])+"="+t(n[1])},"").join("&")};function Na(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Si(e,t,n){if(!t)return e;const o=n&&n.encode||Na,i=n&&n.serialize;let s;if(i?s=i(t,n):s=h.isURLSearchParams(t)?t.toString():new zn(t,n).toString(o),s){const a=e.indexOf("#");a!==-1&&(e=e.slice(0,a)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class Do{constructor(){this.handlers=[]}use(t,n,o){return this.handlers.push({fulfilled:t,rejected:n,synchronous:o?o.synchronous:!1,runWhen:o?o.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){h.forEach(this.handlers,function(n){n!==null&&t(n)})}}const Oi={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Da=typeof URLSearchParams<"u"?URLSearchParams:zn,qa=typeof FormData<"u"?FormData:null,Ia=typeof Blob<"u"?Blob:null,La={isBrowser:!0,classes:{URLSearchParams:Da,FormData:qa,Blob:Ia},protocols:["http","https","file","blob","url","data"]},Ei=typeof window<"u"&&typeof document<"u",ja=(e=>Ei&&["ReactNative","NativeScript","NS"].indexOf(e)<0)(typeof navigator<"u"&&navigator.product),Fa=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Ua=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ei,hasStandardBrowserEnv:ja,hasStandardBrowserWebWorkerEnv:Fa},Symbol.toStringTag,{value:"Module"})),xe={...Ua,...La};function Ma(e,t){return fn(e,new xe.classes.URLSearchParams,Object.assign({visitor:function(n,o,i,s){return xe.isNode&&h.isBuffer(n)?(this.append(o,n.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},t))}function $a(e){return h.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Ha(e){const t={},n=Object.keys(e);let o;const i=n.length;let s;for(o=0;o<i;o++)s=n[o],t[s]=e[s];return t}function Ai(e){function t(n,o,i,s){let a=n[s++];if(a==="__proto__")return!0;const l=Number.isFinite(+a),c=s>=n.length;return a=!a&&h.isArray(i)?i.length:a,c?(h.hasOwnProp(i,a)?i[a]=[i[a],o]:i[a]=o,!l):((!i[a]||!h.isObject(i[a]))&&(i[a]=[]),t(n,o,i[a],s)&&h.isArray(i[a])&&(i[a]=Ha(i[a])),!l)}if(h.isFormData(e)&&h.isFunction(e.entries)){const n={};return h.forEachEntry(e,(o,i)=>{t($a(o),i,n,0)}),n}return null}function Va(e,t,n){if(h.isString(e))try{return(t||JSON.parse)(e),h.trim(e)}catch(o){if(o.name!=="SyntaxError")throw o}return(n||JSON.stringify)(e)}const Kn={transitional:Oi,adapter:["xhr","http"],transformRequest:[function(e,t){const n=t.getContentType()||"",o=n.indexOf("application/json")>-1,i=h.isObject(e);if(i&&h.isHTMLForm(e)&&(e=new FormData(e)),h.isFormData(e))return o&&o?JSON.stringify(Ai(e)):e;if(h.isArrayBuffer(e)||h.isBuffer(e)||h.isStream(e)||h.isFile(e)||h.isBlob(e))return e;if(h.isArrayBufferView(e))return e.buffer;if(h.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let s;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return Ma(e,this.formSerializer).toString();if((s=h.isFileList(e))||n.indexOf("multipart/form-data")>-1){const a=this.env&&this.env.FormData;return fn(s?{"files[]":e}:e,a&&new a,this.formSerializer)}}return i||o?(t.setContentType("application/json",!1),Va(e)):e}],transformResponse:[function(e){const t=this.transitional||Kn.transitional,n=t&&t.forcedJSONParsing,o=this.responseType==="json";if(e&&h.isString(e)&&(n&&!this.responseType||o)){const i=!(t&&t.silentJSONParsing)&&o;try{return JSON.parse(e)}catch(s){if(i)throw s.name==="SyntaxError"?B.from(s,B.ERR_BAD_RESPONSE,this,null,this.response):s}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:xe.classes.FormData,Blob:xe.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};h.forEach(["delete","get","head","post","put","patch"],e=>{Kn.headers[e]={}});const Wn=Kn,za=h.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Ka=e=>{const t={};let n,o,i;return e&&e.split(`
`).forEach(function(s){i=s.indexOf(":"),n=s.substring(0,i).trim().toLowerCase(),o=s.substring(i+1).trim(),!(!n||t[n]&&za[n])&&(n==="set-cookie"?t[n]?t[n].push(o):t[n]=[o]:t[n]=t[n]?t[n]+", "+o:o)}),t},qo=Symbol("internals");function Ct(e){return e&&String(e).trim().toLowerCase()}function nn(e){return e===!1||e==null?e:h.isArray(e)?e.map(nn):String(e)}function Wa(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let o;for(;o=n.exec(e);)t[o[1]]=o[2];return t}const Ja=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function An(e,t,n,o,i){if(h.isFunction(o))return o.call(this,t,n);if(i&&(t=n),!!h.isString(t)){if(h.isString(o))return t.indexOf(o)!==-1;if(h.isRegExp(o))return o.test(t)}}function Ga(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,o)=>n.toUpperCase()+o)}function Qa(e,t){const n=h.toCamelCase(" "+t);["get","set","has"].forEach(o=>{Object.defineProperty(e,o+n,{value:function(i,s,a){return this[o].call(this,t,i,s,a)},configurable:!0})})}let dn=class{constructor(e){e&&this.set(e)}set(e,t,n){const o=this;function i(a,l,c){const u=Ct(l);if(!u)throw new Error("header name must be a non-empty string");const r=h.findKey(o,u);(!r||o[r]===void 0||c===!0||c===void 0&&o[r]!==!1)&&(o[r||l]=nn(a))}const s=(a,l)=>h.forEach(a,(c,u)=>i(c,u,l));return h.isPlainObject(e)||e instanceof this.constructor?s(e,t):h.isString(e)&&(e=e.trim())&&!Ja(e)?s(Ka(e),t):e!=null&&i(t,e,n),this}get(e,t){if(e=Ct(e),e){const n=h.findKey(this,e);if(n){const o=this[n];if(!t)return o;if(t===!0)return Wa(o);if(h.isFunction(t))return t.call(this,o,n);if(h.isRegExp(t))return t.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Ct(e),e){const n=h.findKey(this,e);return!!(n&&this[n]!==void 0&&(!t||An(this,this[n],n,t)))}return!1}delete(e,t){const n=this;let o=!1;function i(s){if(s=Ct(s),s){const a=h.findKey(n,s);a&&(!t||An(n,n[a],a,t))&&(delete n[a],o=!0)}}return h.isArray(e)?e.forEach(i):i(e),o}clear(e){const t=Object.keys(this);let n=t.length,o=!1;for(;n--;){const i=t[n];(!e||An(this,this[i],i,e,!0))&&(delete this[i],o=!0)}return o}normalize(e){const t=this,n={};return h.forEach(this,(o,i)=>{const s=h.findKey(n,i);if(s){t[s]=nn(o),delete t[i];return}const a=e?Ga(i):String(i).trim();a!==i&&delete t[i],t[a]=nn(o),n[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return h.forEach(this,(n,o)=>{n!=null&&n!==!1&&(t[o]=e&&h.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach(o=>n.set(o)),n}static accessor(e){const t=(this[qo]=this[qo]={accessors:{}}).accessors,n=this.prototype;function o(i){const s=Ct(i);t[s]||(Qa(n,i),t[s]=!0)}return h.isArray(e)?e.forEach(o):o(e),this}};dn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);h.reduceDescriptors(dn.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(o){this[n]=o}}});h.freezeMethods(dn);const je=dn;function Pn(e,t){const n=this||Wn,o=t||n,i=je.from(o.headers);let s=o.data;return h.forEach(e,function(a){s=a.call(n,s,i.normalize(),t?t.status:void 0)}),i.normalize(),s}function Pi(e){return!!(e&&e.__CANCEL__)}function Ft(e,t,n){B.call(this,e??"canceled",B.ERR_CANCELED,t,n),this.name="CanceledError"}h.inherits(Ft,B,{__CANCEL__:!0});function Ya(e,t,n){const o=n.config.validateStatus;!n.status||!o||o(n.status)?e(n):t(new B("Request failed with status code "+n.status,[B.ERR_BAD_REQUEST,B.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}const Xa=xe.hasStandardBrowserEnv?{write(e,t,n,o,i,s){const a=[e+"="+encodeURIComponent(t)];h.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),h.isString(o)&&a.push("path="+o),h.isString(i)&&a.push("domain="+i),s===!0&&a.push("secure"),document.cookie=a.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Za(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function er(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Bi(e,t){return e&&!Za(t)?er(e,t):t}const tr=xe.hasStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a");let n;function o(i){let s=i;return e&&(t.setAttribute("href",s),s=t.href),t.setAttribute("href",s),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:t.pathname.charAt(0)==="/"?t.pathname:"/"+t.pathname}}return n=o(window.location.href),function(i){const s=h.isString(i)?o(i):i;return s.protocol===n.protocol&&s.host===n.host}}():function(){return function(){return!0}}();function nr(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function or(e,t){e=e||10;const n=new Array(e),o=new Array(e);let i=0,s=0,a;return t=t!==void 0?t:1e3,function(l){const c=Date.now(),u=o[s];a||(a=c),n[i]=l,o[i]=c;let r=s,g=0;for(;r!==i;)g+=n[r++],r=r%e;if(i=(i+1)%e,i===s&&(s=(s+1)%e),c-a<t)return;const w=u&&c-u;return w?Math.round(g*1e3/w):void 0}}function Io(e,t){let n=0;const o=or(50,250);return i=>{const s=i.loaded,a=i.lengthComputable?i.total:void 0,l=s-n,c=o(l),u=s<=a;n=s;const r={loaded:s,total:a,progress:a?s/a:void 0,bytes:l,rate:c||void 0,estimated:c&&a&&u?(a-s)/c:void 0,event:i};r[t?"download":"upload"]=!0,e(r)}}const ir=typeof XMLHttpRequest<"u",sr=ir&&function(e){return new Promise(function(t,n){let o=e.data;const i=je.from(e.headers).normalize();let{responseType:s,withXSRFToken:a}=e,l;function c(){e.cancelToken&&e.cancelToken.unsubscribe(l),e.signal&&e.signal.removeEventListener("abort",l)}let u;if(h.isFormData(o)){if(xe.hasStandardBrowserEnv||xe.hasStandardBrowserWebWorkerEnv)i.setContentType(!1);else if((u=i.getContentType())!==!1){const[_,...E]=u?u.split(";").map(D=>D.trim()).filter(Boolean):[];i.setContentType([_||"multipart/form-data",...E].join("; "))}}let r=new XMLHttpRequest;if(e.auth){const _=e.auth.username||"",E=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";i.set("Authorization","Basic "+btoa(_+":"+E))}const g=Bi(e.baseURL,e.url);r.open(e.method.toUpperCase(),Si(g,e.params,e.paramsSerializer),!0),r.timeout=e.timeout;function w(){if(!r)return;const _=je.from("getAllResponseHeaders"in r&&r.getAllResponseHeaders()),E={data:!s||s==="text"||s==="json"?r.responseText:r.response,status:r.status,statusText:r.statusText,headers:_,config:e,request:r};Ya(function(D){t(D),c()},function(D){n(D),c()},E),r=null}if("onloadend"in r?r.onloadend=w:r.onreadystatechange=function(){!r||r.readyState!==4||r.status===0&&!(r.responseURL&&r.responseURL.indexOf("file:")===0)||setTimeout(w)},r.onabort=function(){r&&(n(new B("Request aborted",B.ECONNABORTED,e,r)),r=null)},r.onerror=function(){n(new B("Network Error",B.ERR_NETWORK,e,r)),r=null},r.ontimeout=function(){let _=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";const E=e.transitional||Oi;e.timeoutErrorMessage&&(_=e.timeoutErrorMessage),n(new B(_,E.clarifyTimeoutError?B.ETIMEDOUT:B.ECONNABORTED,e,r)),r=null},xe.hasStandardBrowserEnv&&(a&&h.isFunction(a)&&(a=a(e)),a||a!==!1&&tr(g))){const _=e.xsrfHeaderName&&e.xsrfCookieName&&Xa.read(e.xsrfCookieName);_&&i.set(e.xsrfHeaderName,_)}o===void 0&&i.setContentType(null),"setRequestHeader"in r&&h.forEach(i.toJSON(),function(_,E){r.setRequestHeader(E,_)}),h.isUndefined(e.withCredentials)||(r.withCredentials=!!e.withCredentials),s&&s!=="json"&&(r.responseType=e.responseType),typeof e.onDownloadProgress=="function"&&r.addEventListener("progress",Io(e.onDownloadProgress,!0)),typeof e.onUploadProgress=="function"&&r.upload&&r.upload.addEventListener("progress",Io(e.onUploadProgress)),(e.cancelToken||e.signal)&&(l=_=>{r&&(n(!_||_.type?new Ft(null,e,r):_),r.abort(),r=null)},e.cancelToken&&e.cancelToken.subscribe(l),e.signal&&(e.signal.aborted?l():e.signal.addEventListener("abort",l)));const m=nr(g);if(m&&xe.protocols.indexOf(m)===-1){n(new B("Unsupported protocol "+m+":",B.ERR_BAD_REQUEST,e));return}r.send(o||null)})},In={http:Ca,xhr:sr};h.forEach(In,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Lo=e=>`- ${e}`,ar=e=>h.isFunction(e)||e===null||e===!1,Ci={getAdapter:e=>{e=h.isArray(e)?e:[e];const{length:t}=e;let n,o;const i={};for(let s=0;s<t;s++){n=e[s];let a;if(o=n,!ar(n)&&(o=In[(a=String(n)).toLowerCase()],o===void 0))throw new B(`Unknown adapter '${a}'`);if(o)break;i[a||"#"+s]=o}if(!o){const s=Object.entries(i).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let a=t?s.length>1?`since :
`+s.map(Lo).join(`
`):" "+Lo(s[0]):"as no adapter specified";throw new B("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return o},adapters:In};function Bn(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Ft(null,e)}function jo(e){return Bn(e),e.headers=je.from(e.headers),e.data=Pn.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Ci.getAdapter(e.adapter||Wn.adapter)(e).then(function(t){return Bn(e),t.data=Pn.call(e,e.transformResponse,t),t.headers=je.from(t.headers),t},function(t){return Pi(t)||(Bn(e),t&&t.response&&(t.response.data=Pn.call(e,e.transformResponse,t.response),t.response.headers=je.from(t.response.headers))),Promise.reject(t)})}const Fo=e=>e instanceof je?e.toJSON():e;function Tt(e,t){t=t||{};const n={};function o(u,r,g){return h.isPlainObject(u)&&h.isPlainObject(r)?h.merge.call({caseless:g},u,r):h.isPlainObject(r)?h.merge({},r):h.isArray(r)?r.slice():r}function i(u,r,g){if(h.isUndefined(r)){if(!h.isUndefined(u))return o(void 0,u,g)}else return o(u,r,g)}function s(u,r){if(!h.isUndefined(r))return o(void 0,r)}function a(u,r){if(h.isUndefined(r)){if(!h.isUndefined(u))return o(void 0,u)}else return o(void 0,r)}function l(u,r,g){if(g in t)return o(u,r);if(g in e)return o(void 0,u)}const c={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:l,headers:(u,r)=>i(Fo(u),Fo(r),!0)};return h.forEach(Object.keys(Object.assign({},e,t)),function(u){const r=c[u]||i,g=r(e[u],t[u],u);h.isUndefined(g)&&r!==l||(n[u]=g)}),n}const xi="1.6.5",Jn={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Jn[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const Uo={};Jn.transitional=function(e,t,n){function o(i,s){return"[Axios v"+xi+"] Transitional option '"+i+"'"+s+(n?". "+n:"")}return(i,s,a)=>{if(e===!1)throw new B(o(s," has been removed"+(t?" in "+t:"")),B.ERR_DEPRECATED);return t&&!Uo[s]&&(Uo[s]=!0,console.warn(o(s," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(i,s,a):!0}};function rr(e,t,n){if(typeof e!="object")throw new B("options must be an object",B.ERR_BAD_OPTION_VALUE);const o=Object.keys(e);let i=o.length;for(;i-- >0;){const s=o[i],a=t[s];if(a){const l=e[s],c=l===void 0||a(l,s,e);if(c!==!0)throw new B("option "+s+" must be "+c,B.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new B("Unknown option "+s,B.ERR_BAD_OPTION)}}const Ln={assertOptions:rr,validators:Jn},Ke=Ln.validators;let an=class{constructor(e){this.defaults=e,this.interceptors={request:new Do,response:new Do}}request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=Tt(this.defaults,t);const{transitional:n,paramsSerializer:o,headers:i}=t;n!==void 0&&Ln.assertOptions(n,{silentJSONParsing:Ke.transitional(Ke.boolean),forcedJSONParsing:Ke.transitional(Ke.boolean),clarifyTimeoutError:Ke.transitional(Ke.boolean)},!1),o!=null&&(h.isFunction(o)?t.paramsSerializer={serialize:o}:Ln.assertOptions(o,{encode:Ke.function,serialize:Ke.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let s=i&&h.merge(i.common,i[t.method]);i&&h.forEach(["delete","get","head","post","put","patch","common"],m=>{delete i[m]}),t.headers=je.concat(s,i);const a=[];let l=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(t)===!1||(l=l&&m.synchronous,a.unshift(m.fulfilled,m.rejected))});const c=[];this.interceptors.response.forEach(function(m){c.push(m.fulfilled,m.rejected)});let u,r=0,g;if(!l){const m=[jo.bind(this),void 0];for(m.unshift.apply(m,a),m.push.apply(m,c),g=m.length,u=Promise.resolve(t);r<g;)u=u.then(m[r++],m[r++]);return u}g=a.length;let w=t;for(r=0;r<g;){const m=a[r++],_=a[r++];try{w=m(w)}catch(E){_.call(this,E);break}}try{u=jo.call(this,w)}catch(m){return Promise.reject(m)}for(r=0,g=c.length;r<g;)u=u.then(c[r++],c[r++]);return u}getUri(e){e=Tt(this.defaults,e);const t=Bi(e.baseURL,e.url);return Si(t,e.params,e.paramsSerializer)}};h.forEach(["delete","get","head","options"],function(e){an.prototype[e]=function(t,n){return this.request(Tt(n||{},{method:e,url:t,data:(n||{}).data}))}});h.forEach(["post","put","patch"],function(e){function t(n){return function(o,i,s){return this.request(Tt(s||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:o,data:i}))}}an.prototype[e]=t(),an.prototype[e+"Form"]=t(!0)});const on=an;let lr=class Ri{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const o=this;this.promise.then(i=>{if(!o._listeners)return;let s=o._listeners.length;for(;s-- >0;)o._listeners[s](i);o._listeners=null}),this.promise.then=i=>{let s;const a=new Promise(l=>{o.subscribe(l),s=l}).then(i);return a.cancel=function(){o.unsubscribe(s)},a},t(function(i,s,a){o.reason||(o.reason=new Ft(i,s,a),n(o.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}static source(){let t;return{token:new Ri(function(n){t=n}),cancel:t}}};const cr=lr;function ur(e){return function(t){return e.apply(null,t)}}function pr(e){return h.isObject(e)&&e.isAxiosError===!0}const jn={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(jn).forEach(([e,t])=>{jn[t]=e});const fr=jn;function Ni(e){const t=new on(e),n=fi(on.prototype.request,t);return h.extend(n,on.prototype,t,{allOwnKeys:!0}),h.extend(n,t,null,{allOwnKeys:!0}),n.create=function(o){return Ni(Tt(e,o))},n}const z=Ni(Wn);z.Axios=on;z.CanceledError=Ft;z.CancelToken=cr;z.isCancel=Pi;z.VERSION=xi;z.toFormData=fn;z.AxiosError=B;z.Cancel=z.CanceledError;z.all=function(e){return Promise.all(e)};z.spread=ur;z.isAxiosError=pr;z.mergeConfig=Tt;z.AxiosHeaders=je;z.formToJSON=e=>Ai(h.isHTMLForm(e)?new FormData(e):e);z.getAdapter=Ci.getAdapter;z.HttpStatusCode=fr;z.default=z;const{Axios:gl,AxiosError:bl,CanceledError:yl,isCancel:_l,CancelToken:wl,VERSION:kl,all:vl,Cancel:Tl,isAxiosError:Sl,spread:Ol,toFormData:El,AxiosHeaders:Al,HttpStatusCode:en,formToJSON:Pl,getAdapter:Bl,mergeConfig:Cl}=z;var _t=null;typeof WebSocket<"u"?_t=WebSocket:typeof MozWebSocket<"u"?_t=MozWebSocket:typeof global<"u"?_t=global.WebSocket||global.MozWebSocket:typeof window<"u"?_t=window.WebSocket||window.MozWebSocket:typeof self<"u"&&(_t=self.WebSocket||self.MozWebSocket);const dr=_t,Cn={SCHEMA_DIR_RELATIVE_PATH:"./../schemas/",SCHEMA_FILENAME_PAYLOAD:"payload.schema.json",SCHEMA_FILENAME_RESPONSE:"response.schema.json",SIYUAN_DEFAULT_BASE_URL:"http://localhost:6806/",SIYUAN_DEFAULT_TOKEN:"",REQUEST_TIMEOUT:6e4};var Mo,$o,Ho,Vo,zo;const Fn=class f{constructor(t={},n="xhr"){Ie(this,"_type","xhr"),Ie(this,"_baseURL",(($o=(Mo=globalThis.top)==null?void 0:Mo.document)==null?void 0:$o.baseURI)??((Vo=(Ho=globalThis.parent)==null?void 0:Ho.document)==null?void 0:Vo.baseURI)??((zo=globalThis.location)==null?void 0:zo.origin)??Cn.SIYUAN_DEFAULT_BASE_URL),Ie(this,"_token",Cn.SIYUAN_DEFAULT_TOKEN),Ie(this,"_axios",z.create({baseURL:this._baseURL,timeout:Cn.REQUEST_TIMEOUT,headers:{Authorization:`Token ${this._token}`}})),Ie(this,"_fetch",Ws.create({baseURL:this._baseURL,headers:{Authorization:`Token ${this._token}`}})),this._setClientType(n),this._updateOptions(t,n)}static headers2record(t){const n={};return t.forEach((o,i)=>{n[i]=o}),n}static entries2record(t){const n={};for(const[o,i]of t)n[o]=i;return n}_setClientType(t){this._type=t}_updateOptions(t,n=this._type){switch(this._token=t.token??this._token,this._baseURL=t.baseURL??this._baseURL,n){case"fetch":const o=t;if(o.token){const i="Authorization",s=`Token ${t.token}`;Array.isArray(o.headers)?o.headers.push([i,s]):o.headers instanceof Headers?o.headers.set(i,s):typeof o.headers=="object"?o.headers[i]=s:o.headers={[i]:s},delete t.token}this._fetch=this._fetch.create(o);break;case"xhr":default:for(const[i,s]of Object.entries(t))switch(i){case"token":this._axios.defaults.headers.Authorization=`Token ${this._token}`;break;default:this._axios.defaults[i]=s;break}break}this._baseURL=t.baseURL??this._baseURL}broadcast(t,n,o){const i=(o==null?void 0:o.baseURL)??this._baseURL,s=(o==null?void 0:o.token)??this._token,a=new URLSearchParams(t);s&&a.set("token",s);const l=new URL(i);return l.protocol=l.protocol.replace(/^http/,"ws"),l.pathname=l.pathname.endsWith("/")?`${l.pathname}${f.ws.broadcast.pathname.substring(1)}`:`${l.pathname}${f.ws.broadcast.pathname}`,l.search=a.toString(),new dr(l,n)}async upload(t,n){const o=new FormData;return o.append("assetsDirPath",t.assetsDirPath??"/assets/"),t.files.forEach(i=>o.append("file[]",i)),await this._request(f.api.asset.upload.pathname,f.api.asset.upload.method,o,n)}async getBlockAttrs(t,n){return await this._request(f.api.attr.getBlockAttrs.pathname,f.api.attr.getBlockAttrs.method,t,n)}async getBookmarkLabels(t){return await this._request(f.api.attr.getBookmarkLabels.pathname,f.api.attr.getBookmarkLabels.method,void 0,t)}async setBlockAttrs(t,n){return await this._request(f.api.attr.setBlockAttrs.pathname,f.api.attr.setBlockAttrs.method,t,n)}async appendBlock(t,n){return await this._request(f.api.block.appendBlock.pathname,f.api.block.appendBlock.method,t,n)}async deleteBlock(t,n){return await this._request(f.api.block.deleteBlock.pathname,f.api.block.deleteBlock.method,t,n)}async getBlockBreadcrumb(t,n){return await this._request(f.api.block.getBlockBreadcrumb.pathname,f.api.block.getBlockBreadcrumb.method,t,n)}async getBlockDOM(t,n){return await this._request(f.api.block.getBlockDOM.pathname,f.api.block.getBlockDOM.method,t,n)}async getBlockInfo(t,n){return await this._request(f.api.block.getBlockInfo.pathname,f.api.block.getBlockInfo.method,t,n)}async getBlockKramdown(t,n){return await this._request(f.api.block.getBlockKramdown.pathname,f.api.block.getBlockKramdown.method,t,n)}async getChildBlocks(t,n){return await this._request(f.api.block.getChildBlocks.pathname,f.api.block.getChildBlocks.method,t,n)}async getDocInfo(t,n){return await this._request(f.api.block.getDocInfo.pathname,f.api.block.getDocInfo.method,t,n)}async insertBlock(t,n){return await this._request(f.api.block.insertBlock.pathname,f.api.block.insertBlock.method,t,n)}async moveBlock(t,n){return await this._request(f.api.block.moveBlock.pathname,f.api.block.moveBlock.method,t,n)}async prependBlock(t,n){return await this._request(f.api.block.prependBlock.pathname,f.api.block.prependBlock.method,t,n)}async transferBlockRef(t,n){return await this._request(f.api.block.transferBlockRef.pathname,f.api.block.transferBlockRef.method,t,n)}async updateBlock(t,n){return await this._request(f.api.block.updateBlock.pathname,f.api.block.updateBlock.method,t,n)}async getChannelInfo(t,n){return await this._request(f.api.broadcast.getChannelInfo.pathname,f.api.broadcast.getChannelInfo.method,t,n)}async getChannels(t){return await this._request(f.api.broadcast.getChannels.pathname,f.api.broadcast.getChannels.method,void 0,t)}async postMessage(t,n){return await this._request(f.api.broadcast.postMessage.pathname,f.api.broadcast.postMessage.method,t,n)}async pandoc(t,n){return await this._request(f.api.convert.pandoc.pathname,f.api.convert.pandoc.method,t,n)}async exportResources(t,n){return await this._request(f.api.export.exportResources.pathname,f.api.export.exportResources.method,t,n)}async exportMdContent(t,n){return await this._request(f.api.export.exportMdContent.pathname,f.api.export.exportMdContent.method,t,n)}async getFile(t,n="text",o){return await this._request(f.api.file.getFile.pathname,f.api.file.getFile.method,t,o,!1,n)}async putFile(t,n){t.file!==void 0&&!(t.file instanceof File)&&(t.file=new File([t.file],t.path.split("/").pop()));const o=new FormData;for(const[i,s]of Object.entries(t))t.hasOwnProperty(i)&&(s instanceof Blob?o.append(i,s):o.append(i,String(s)));return await this._request(f.api.file.putFile.pathname,f.api.file.putFile.method,o,n)}async readDir(t,n){return await this._request(f.api.file.readDir.pathname,f.api.file.readDir.method,t,n)}async removeFile(t,n){return await this._request(f.api.file.removeFile.pathname,f.api.file.removeFile.method,t,n)}async renameFile(t,n){return await this._request(f.api.file.renameFile.pathname,f.api.file.renameFile.method,t,n)}async createDailyNote(t,n){return await this._request(f.api.filetree.createDailyNote.pathname,f.api.filetree.createDailyNote.method,t,n)}async createDocWithMd(t,n){return await this._request(f.api.filetree.createDocWithMd.pathname,f.api.filetree.createDocWithMd.method,t,n)}async getDoc(t,n){return await this._request(f.api.filetree.getDoc.pathname,f.api.filetree.getDoc.method,t,n)}async getHPathByID(t,n){return await this._request(f.api.filetree.getHPathByID.pathname,f.api.filetree.getHPathByID.method,t,n)}async getHPathByPath(t,n){return await this._request(f.api.filetree.getHPathByPath.pathname,f.api.filetree.getHPathByPath.method,t,n)}async getIDsByHPath(t,n){return await this._request(f.api.filetree.getIDsByHPath.pathname,f.api.filetree.getIDsByHPath.method,t,n)}async listDocsByPath(t,n){return await this._request(f.api.filetree.listDocsByPath.pathname,f.api.filetree.listDocsByPath.method,t,n)}async moveDocs(t,n){return await this._request(f.api.filetree.moveDocs.pathname,f.api.filetree.moveDocs.method,t,n)}async removeDoc(t,n){return await this._request(f.api.filetree.removeDoc.pathname,f.api.filetree.removeDoc.method,t,n)}async renameDoc(t,n){return await this._request(f.api.filetree.renameDoc.pathname,f.api.filetree.renameDoc.method,t,n)}async searchDocs(t,n){return await this._request(f.api.filetree.searchDocs.pathname,f.api.filetree.searchDocs.method,t,n)}async getDocHistoryContent(t,n){return await this._request(f.api.history.getDocHistoryContent.pathname,f.api.history.getDocHistoryContent.method,t,n)}async getHistoryItems(t,n){return await this._request(f.api.history.getHistoryItems.pathname,f.api.history.getHistoryItems.method,t,n)}async getShorthand(t,n){return await this._request(f.api.inbox.getShorthand.pathname,f.api.inbox.getShorthand.method,t,n)}async echo(t,n){if(t)switch(n??(n={type:this._type}),n==null?void 0:n.type){case"fetch":{const o={};t.headers&&(o.headers=t.headers),t.query&&(o.query=f.entries2record(t.query.entries())),n.options?Object.assign(o,n.options):n.options=o;break}case"xhr":{const o={};t.headers&&(o.headers=Array.isArray(t.headers)?f.entries2record(t.headers):t.headers instanceof Headers?f.headers2record(t.headers):t.headers),t.query&&(o.params=t.query),n.options?Object.assign(o,n.options):n.options=o;break}}return await this._request(f.api.network.echo.pathname,(t==null?void 0:t.method)??f.api.network.echo.method,t==null?void 0:t.body,n)}async forwardProxy(t,n){return await this._request(f.api.network.forwardProxy.pathname,f.api.network.forwardProxy.method,t,n)}async closeNotebook(t,n){return await this._request(f.api.notebook.closeNotebook.pathname,f.api.notebook.closeNotebook.method,t,n)}async createNotebook(t,n){return await this._request(f.api.notebook.createNotebook.pathname,f.api.notebook.createNotebook.method,t,n)}async getNotebookConf(t,n){return await this._request(f.api.notebook.getNotebookConf.pathname,f.api.notebook.getNotebookConf.method,t,n)}async lsNotebooks(t){return await this._request(f.api.notebook.lsNotebooks.pathname,f.api.notebook.lsNotebooks.method,void 0,t)}async openNotebook(t,n){return await this._request(f.api.notebook.openNotebook.pathname,f.api.notebook.openNotebook.method,t,n)}async removeNotebook(t,n){return await this._request(f.api.notebook.removeNotebook.pathname,f.api.notebook.removeNotebook.method,t,n)}async renameNotebook(t,n){return await this._request(f.api.notebook.renameNotebook.pathname,f.api.notebook.renameNotebook.method,t,n)}async setNotebookConf(t,n){return await this._request(f.api.notebook.setNotebookConf.pathname,f.api.notebook.setNotebookConf.method,t,n)}async pushErrMsg(t,n){return await this._request(f.api.notification.pushErrMsg.pathname,f.api.notification.pushErrMsg.method,t,n)}async pushMsg(t,n){return await this._request(f.api.notification.pushMsg.pathname,f.api.notification.pushMsg.method,t,n)}async getDocOutline(t,n){return await this._request(f.api.outline.getDocOutline.pathname,f.api.outline.getDocOutline.method,t,n)}async sql(t,n){return await this._request(f.api.query.sql.pathname,f.api.query.sql.method,t,n)}async openRepoSnapshotDoc(t,n){return await this._request(f.api.repo.openRepoSnapshotDoc.pathname,f.api.repo.openRepoSnapshotDoc.method,t,n)}async fullTextSearchBlock(t,n){return await this._request(f.api.search.fullTextSearchBlock.pathname,f.api.search.fullTextSearchBlock.method,t,n)}async getSnippet(t,n){return await this._request(f.api.snippet.getSnippet.pathname,f.api.snippet.getSnippet.method,t,n)}async setSnippet(t,n){return await this._request(f.api.snippet.setSnippet.pathname,f.api.snippet.setSnippet.method,t,n)}async getLocalStorage(t){return await this._request(f.api.storage.getLocalStorage.pathname,f.api.storage.getLocalStorage.method,void 0,t)}async getRecentDocs(t){return await this._request(f.api.storage.getRecentDocs.pathname,f.api.storage.getRecentDocs.method,void 0,t)}async setLocalStorage(t,n){return await this._request(f.api.storage.setLocalStorage.pathname,f.api.storage.setLocalStorage.method,t,n)}async setLocalStorageVal(t,n){return await this._request(f.api.storage.setLocalStorageVal.pathname,f.api.storage.setLocalStorageVal.method,t,n)}async bootProgress(t){return await this._request(f.api.system.bootProgress.pathname,f.api.system.bootProgress.method,void 0,t)}async getConf(t){return await this._request(f.api.system.getConf.pathname,f.api.system.getConf.method,void 0,t)}async currentTime(t){return await this._request(f.api.system.currentTime.pathname,f.api.system.currentTime.method,void 0,t)}async version(t){return await this._request(f.api.system.version.pathname,f.api.system.version.method,void 0,t)}async render(t,n){return await this._request(f.api.template.render.pathname,f.api.template.render.method,t,n)}async renderSprig(t,n){return await this._request(f.api.template.renderSprig.pathname,f.api.template.renderSprig.method,t,n)}async _request(t,n,o,i,s=!0,a="json"){try{switch((i==null?void 0:i.type)??this._type){case"fetch":{const l=i==null?void 0:i.options;a=(()=>{switch(a){case"arraybuffer":return"arrayBuffer";case"document":return"text";default:return a}})();const c=await this._fetch(t,{method:n,body:o,responseType:a,onResponse:async u=>{switch(u.response.status){case en.Ok:switch(a){case"blob":u.response._data.contentType=u.response.headers.get("content-type");break;default:break}break;case en.Accepted:t===f.api.file.getFile.pathname&&this._parseFetchResponse(u.response._data);break;default:break}},...l});return s&&a==="json"&&typeof c=="object"?this._parseFetchResponse(c):c}case"xhr":default:{const l=i==null?void 0:i.options;a=(()=>{switch(a){case"arrayBuffer":return"arraybuffer";default:return a}})();const c=await this._axios.request({url:t,method:n,data:o,responseType:a,...l});switch(c.status){case en.Ok:if(s&&a==="json"&&typeof c.data=="object")return this._parseAxiosResponse(c);switch(a){case"blob":c.data.contentType=c.headers.getContentType();break;default:break}return c.data;case en.Accepted:return t===f.api.file.getFile.pathname?this._parseAxiosResponse(c):c.data;default:throw new Js(c)}}}}catch(l){throw l}}_parseFetchResponse(t){if(t.code===0)return t;throw new Po(t)}_parseAxiosResponse(t){if(t.data.code===0)return t.data;throw new Po(t.data,t)}};Ie(Fn,"ws",{broadcast:{pathname:"/ws/broadcast"}}),Ie(Fn,"api",{asset:{upload:{pathname:"/api/asset/upload",method:"POST"}},attr:{getBlockAttrs:{pathname:"/api/attr/getBlockAttrs",method:"POST"},getBookmarkLabels:{pathname:"/api/attr/getBookmarkLabels",method:"POST"},setBlockAttrs:{pathname:"/api/attr/setBlockAttrs",method:"POST"}},block:{appendBlock:{pathname:"/api/block/appendBlock",method:"POST"},deleteBlock:{pathname:"/api/block/deleteBlock",method:"POST"},getBlockBreadcrumb:{pathname:"/api/block/getBlockBreadcrumb",method:"POST"},getBlockDOM:{pathname:"/api/block/getBlockDOM",method:"POST"},getBlockInfo:{pathname:"/api/block/getBlockInfo",method:"POST"},getBlockKramdown:{pathname:"/api/block/getBlockKramdown",method:"POST"},getChildBlocks:{pathname:"/api/block/getChildBlocks",method:"POST"},getDocInfo:{pathname:"/api/block/getDocInfo",method:"POST"},insertBlock:{pathname:"/api/block/insertBlock",method:"POST"},moveBlock:{pathname:"/api/block/moveBlock",method:"POST"},prependBlock:{pathname:"/api/block/prependBlock",method:"POST"},transferBlockRef:{pathname:"/api/block/transferBlockRef",method:"POST"},updateBlock:{pathname:"/api/block/updateBlock",method:"POST"}},broadcast:{getChannelInfo:{pathname:"/api/broadcast/getChannelInfo",method:"POST"},getChannels:{pathname:"/api/broadcast/getChannels",method:"POST"},postMessage:{pathname:"/api/broadcast/postMessage",method:"POST"}},convert:{pandoc:{pathname:"/api/convert/pandoc",method:"POST"}},export:{exportMdContent:{pathname:"/api/export/exportMdContent",method:"POST"},exportResources:{pathname:"/api/export/exportResources",method:"POST"}},file:{getFile:{pathname:"/api/file/getFile",method:"POST"},putFile:{pathname:"/api/file/putFile",method:"POST"},readDir:{pathname:"/api/file/readDir",method:"POST"},removeFile:{pathname:"/api/file/removeFile",method:"POST"},renameFile:{pathname:"/api/file/renameFile",method:"POST"}},filetree:{createDailyNote:{pathname:"/api/filetree/createDailyNote",method:"POST"},createDocWithMd:{pathname:"/api/filetree/createDocWithMd",method:"POST"},getDoc:{pathname:"/api/filetree/getDoc",method:"POST"},getHPathByID:{pathname:"/api/filetree/getHPathByID",method:"POST"},getHPathByPath:{pathname:"/api/filetree/getHPathByPath",method:"POST"},getIDsByHPath:{pathname:"/api/filetree/getIDsByHPath",method:"POST"},listDocsByPath:{pathname:"/api/filetree/listDocsByPath",method:"POST"},moveDocs:{pathname:"/api/filetree/moveDocs",method:"POST"},removeDoc:{pathname:"/api/filetree/removeDoc",method:"POST"},renameDoc:{pathname:"/api/filetree/renameDoc",method:"POST"},searchDocs:{pathname:"/api/filetree/searchDocs",method:"POST"}},history:{getDocHistoryContent:{pathname:"/api/history/getDocHistoryContent",method:"POST"},getHistoryItems:{pathname:"/api/history/getHistoryItems",method:"POST"}},inbox:{getShorthand:{pathname:"/api/inbox/getShorthand",method:"POST"}},network:{echo:{pathname:"/api/network/echo",method:"POST"},forwardProxy:{pathname:"/api/network/forwardProxy",method:"POST"}},notebook:{closeNotebook:{pathname:"/api/notebook/closeNotebook",method:"POST"},createNotebook:{pathname:"/api/notebook/createNotebook",method:"POST"},getNotebookConf:{pathname:"/api/notebook/getNotebookConf",method:"POST"},lsNotebooks:{pathname:"/api/notebook/lsNotebooks",method:"POST"},openNotebook:{pathname:"/api/notebook/openNotebook",method:"POST"},removeNotebook:{pathname:"/api/notebook/removeNotebook",method:"POST"},renameNotebook:{pathname:"/api/notebook/renameNotebook",method:"POST"},setNotebookConf:{pathname:"/api/notebook/setNotebookConf",method:"POST"}},notification:{pushErrMsg:{pathname:"/api/notification/pushErrMsg",method:"POST"},pushMsg:{pathname:"/api/notification/pushMsg",method:"POST"}},outline:{getDocOutline:{pathname:"/api/outline/getDocOutline",method:"POST"}},query:{sql:{pathname:"/api/query/sql",method:"POST"}},repo:{openRepoSnapshotDoc:{pathname:"/api/repo/openRepoSnapshotDoc",method:"POST"}},search:{fullTextSearchBlock:{pathname:"/api/search/fullTextSearchBlock",method:"POST"}},snippet:{getSnippet:{pathname:"/api/snippet/getSnippet",method:"POST"},setSnippet:{pathname:"/api/snippet/setSnippet",method:"POST"}},storage:{getLocalStorage:{pathname:"/api/storage/getLocalStorage",method:"POST"},getRecentDocs:{pathname:"/api/storage/getRecentDocs",method:"POST"},setLocalStorage:{pathname:"/api/storage/setLocalStorage",method:"POST"},setLocalStorageVal:{pathname:"/api/storage/setLocalStorageVal",method:"POST"}},system:{bootProgress:{pathname:"/api/system/bootProgress",method:"POST"},currentTime:{pathname:"/api/system/currentTime",method:"POST"},getConf:{pathname:"/api/system/getConf",method:"POST"},version:{pathname:"/api/system/version",method:"POST"}},template:{render:{pathname:"/api/template/render",method:"POST"},renderSprig:{pathname:"/api/template/renderSprig",method:"POST"}}});let hr=Fn,v;function mr(e){v=e}let x;function gr(e){x=e}function Gn(e){return e.replaceAll("[","\\[").replaceAll("]","\\]").replaceAll("'","&apos;")}const Ko=me.getFrontend(),hn=Ko==="mobile"||Ko==="browser-mobile",C=new hr,Y="config",br={icon:!0,depth:0,listType:"unordered",linkType:"ref",docBuilder:!1,autoUpdate:!0,col:1,fold:0,at:!0,outlineAutoUpdate:!1,listTypeOutline:"unordered"};class yr{async initData(){await this.load(),(x.data[Y]===""||x.data[Y]===void 0||x.data[Y]===null)&&await x.saveData(Y,JSON.stringify(br)),await this.load()}set(t,n,o=Y){x.data[o][t]=n}get(t,n=Y){var o;return(o=x.data[n])==null?void 0:o[t]}async load(t=Y){await x.loadData(t)}async save(t=Y){await x.saveData(t,x.data[t])}async saveCopy(t=Y){await x.saveData(t,x.data[Y])}async saveTo(t){x.data[t].docBuilder=x.data[Y].docBuilder,await x.saveData(Y,x.data[t])}async remove(t=Y){await x.removeData(t)}async rename(t,n){await me.fetchSyncPost("/api/file/renameFile",{path:`/data/storage/petal/siyuan-plugins-index/${t}`,newPath:`/data/storage/petal/siyuan-plugins-index/${n}`})}loadSettings(t){this.set("icon",t.icon),this.set("depth",t.depth),this.set("listType",t.listType),this.set("linkType",t.linkType),this.set("fold",t.fold),this.set("col",t.col),this.set("autoUpdate",t.autoUpdate)}loadSettingsforOutline(t){this.set("at",t.at),this.set("outlineType",t.outlineType),this.set("outlineAutoUpdate",t.outlineAutoUpdate)}}const y=new yr;class _r{constructor(t,n){$(this,"depth");$(this,"text");$(this,"path");$(this,"children");this.depth=t,this.text=n,this.children=new Qn}}class Qn{constructor(){$(this,"stack");$(this,"basePath");$(this,"notebookId");$(this,"pPath");this.stack=[]}push(t){return this.stack.push(t)}pop(){return this.stack.pop()}peek(){if(this.stack.length>0)return this.stack[this.stack.length-1]}clear(){this.stack=[]}isEmpty(){return this.stack.length===0}}class Di{constructor(t,n){$(this,"depth");$(this,"text");$(this,"children");this.depth=t,this.text=n,this.children=new Ut}}class Ut{constructor(){$(this,"queue");this.queue=[]}push(t){return this.queue.push(t)}pop(){return this.queue.shift()}getFront(){return this.queue[0]}getRear(){return this.queue[this.queue.length-1]}clear(){this.queue=[]}isEmpty(){return this.queue.length===0}getSize(){return this.queue.length}}let be;async function Un(){await y.load();let e=Yn();if(e==null){C.pushErrMsg({msg:v.errorMsg_empty,timeout:3e3});return}let t=await C.getBlockInfo({id:e}),n="";be=new Ut,await mn(t.data.box,t.data.path,be),n=Mt(be,n),n!=""?await Fi(e,n,"index"):C.pushErrMsg({msg:v.errorMsg_miss,timeout:3e3})}async function qi(e){await y.load();let t=Yn();if(t==null){C.pushErrMsg({msg:v.errorMsg_empty,timeout:3e3});return}let n=await C.getBlockInfo({id:t}),o="";if(be=new Ut,await ji(n.data.box,n.data.path,be),o=Mt(be,o),console.log(o),o!="")await Tr(t,o);else{C.pushErrMsg({msg:v.errorMsg_miss,timeout:3e3});return}e.destroy()}async function Ii(e){await y.load();let t=Yn();if(t==null){C.pushErrMsg({msg:v.errorMsg_empty,timeout:3e3});return}let n="",o=await Xn(t);if(n=Dt(n,o,0,0),n!="")await Fi(t,n,"outline");else{C.pushErrMsg({msg:v.errorMsg_miss_outline,timeout:3e3});return}e.destroy()}async function wr(e,t,n){await y.load();let o="";be=new Ut,await mn(e,n,be),o=Mt(be,o),o!=""?await Zn(t,o,"index"):C.pushErrMsg({msg:v.errorMsg_miss,timeout:3e3})}async function kr(e,t,n){var i;await y.load();let o=await C.sql({stmt:`SELECT * FROM blocks WHERE root_id = '${n}' AND ial like '%custom-index-create%' order by updated desc limit 1`});if(((i=o.data[0])==null?void 0:i.id)!=null){let a=(await C.getBlockAttrs({id:o.data[0].id})).data["custom-index-create"];if(y.loadSettings(JSON.parse(a)),!y.get("autoUpdate"))return;let l="";be=new Ut,await mn(e,t,be),l=Mt(be,l),l!=""?await Zn(o.data[0].id,l,"index"):C.pushErrMsg({msg:v.errorMsg_miss,timeout:3e3})}}async function vr(e){var n;await y.load();let t=await C.sql({stmt:`SELECT * FROM blocks WHERE root_id = '${e}' AND ial like '%custom-outline-create%' order by updated desc limit 1`});if(((n=t.data[0])==null?void 0:n.id)!=null){let i=(await C.getBlockAttrs({id:t.data[0].id})).data["custom-outline-create"];if(y.loadSettings(JSON.parse(i)),!y.get("outlineAutoUpdate"))return;let s="",a=await Xn(e);s=Dt(s,a,0,0),s!=""?await Zn(t.data[0].id,s,"outline"):C.pushErrMsg({msg:v.errorMsg_miss,timeout:3e3})}}function Yn(){var e,t;return hn?(e=document.querySelector("#editor .protyle-content .protyle-background"))==null?void 0:e.getAttribute("data-node-id"):(t=document.querySelector(".layout__wnd--active .protyle.fn__flex-1:not(.fn__none) .protyle-background"))==null?void 0:t.getAttribute("data-node-id")}async function Xn(e){let n=(await C.getDocOutline({id:e})).data;return n??[]}function Dt(e,t,n,o){n++;for(let i of t){let s=i.id,a="";i.depth==0?a=i.name:a=i.content;let l=i.count;for(let g=1;g<=o;g++)e+="    ";e+="> ";for(let g=1;g<n-o;g++)e+="    ";a=Gn(a),y.get("listTypeOutline")=="unordered"?e+="* ":e+="1. ";let u=y.get("outlineType")=="copy",r=y.get("at")?"@":"";u?e+=`${r}${a}((${s} '*'))
`:(u=y.get("outlineType")=="ref",u?e+=`[${r}${a}](siyuan://blocks/${s})
`:e+=`((${s} '${r}${a}'))
`),l>0&&(i.depth==0?e=Dt(e,i.blocks,n,o):e=Dt(e,i.children,n,o))}return e}function Li(e,t){return e==""||e==null?t?"":"":e.indexOf(".")!=-1?e.indexOf("http://")!=-1||e.indexOf("https://")!=-1?t?"":"":`:${e.substring(0,e.lastIndexOf("."))}:`:String.fromCodePoint(parseInt(e,16))}async function ji(e,t,n,o=0){if(y.get("depth")==0||y.get("depth")>o){let i=await C.listDocsByPath({notebook:e,path:t});o++;for(let s of i.data.files){let a="",l=s.id,c=s.name.slice(0,-3),u=s.icon,r=s.subFileCount,g=s.path;for(let D=1;D<o;D++)a+="    ";c=Gn(c),y.get("listType")=="unordered"?a+="* ":a+="1. ",y.get("icon")&&(a+=`${Li(u,r!=0)} `),y.get("linkType")=="ref"?a+=`[${c}](siyuan://blocks/${l})
`:a+=`((${l} '${c}'))
`;let _=await Xn(l);a=Dt(a,_,o,o);let E=new Di(o,a);n.push(E),r>0&&await ji(e,g,E.children,o)}}}async function mn(e,t,n,o=0){if(y.get("depth")==0||y.get("depth")>o){let i=await C.listDocsByPath({notebook:e,path:t});o++;for(let s of i.data.files){let a="",l=s.id,c=s.name.slice(0,-3),u=s.icon,r=s.subFileCount,g=s.path;for(let E=1;E<o;E++)a+="    ";c=Gn(c),y.get("listType")=="unordered"?a+="* ":a+="1. ",y.get("icon")&&(a+=`${Li(u,r!=0)} `),y.get("linkType")=="ref"?a+=`[${c}](siyuan://blocks/${l})
`:a+=`((${l} '${c}'))
`;let _=new Di(o,a);n.push(_),r>0&&await mn(e,g,_.children,o)}}}async function Tr(e,t){await C.insertBlock({data:t,dataType:"markdown",parentID:e}),C.pushMsg({msg:v.msg_success,timeout:3e3})}async function Fi(e,t,n){var i;let o;n=="index"?o={"custom-index-create":JSON.stringify(x.data[Y])}:n=="outline"&&(o={"custom-outline-create":JSON.stringify(x.data[Y])});try{let s=await C.sql({stmt:`SELECT * FROM blocks WHERE root_id = '${e}' AND ial like '%custom-${n}-create%' order by updated desc limit 1`});if(((i=s.data[0])==null?void 0:i.id)==null){let a=await C.insertBlock({data:t,dataType:"markdown",parentID:e});await C.setBlockAttrs({attrs:o,id:a.data[0].doOperations[0].id}),C.pushMsg({msg:v.msg_success,timeout:3e3})}else{let a=await C.updateBlock({data:t,dataType:"markdown",id:s.data[0].id});await C.setBlockAttrs({attrs:o,id:a.data[0].doOperations[0].id}),C.pushMsg({msg:v.update_success,timeout:3e3})}}catch{C.pushErrMsg({msg:v.dclike,timeout:3e3})}}async function Zn(e,t,n){let o;n=="index"?o={"custom-index-create":JSON.stringify(x.data[Y])}:n=="outline"&&(o={"custom-outline-create":JSON.stringify(x.data[Y])});let i=await C.updateBlock({data:t,dataType:"markdown",id:e});await C.setBlockAttrs({id:i.data[0].doOperations[0].id,attrs:o})}function Mt(e,t){var l;if(((l=e.getFront())==null?void 0:l.depth)==null)return"";let n,o=0,i=0,s=0,a=e.getFront().depth;for(a==1&&y.get("col")!=1&&(t+=`{{{col
`,i=Math.trunc(e.getSize()/y.get("col")),s=y.get("col")-1);!e.isEmpty();){if(o++,n=e.pop(),!n.children.isEmpty()&&y.get("fold")!=0&&y.get("fold")<=n.depth){let c=0;y.get("listType")=="unordered"?(c=n.text.indexOf("*"),n.text=n.text.substring(0,c+2)+'{: fold="1"}'+n.text.substring(c+2)):(c=n.text.indexOf("1"),n.text=n.text.substring(0,c+3)+'{: fold="1"}'+n.text.substring(c+3))}t+=n.text,n.children.isEmpty()||(t=Mt(n.children,t)),n.depth==1&&o==i&&s>0&&(t+=`
{: id}
`,o=0,s--)}return a==1&&y.get("col")!=1&&(t+="}}}"),t}function se(){}function Ui(e){return e()}function Wo(){return Object.create(null)}function re(e){e.forEach(Ui)}function $t(e){return typeof e=="function"}function Ot(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function Sr(e){return Object.keys(e).length===0}function d(e,t){e.appendChild(t)}function M(e,t,n){e.insertBefore(t,n||null)}function j(e){e.parentNode&&e.parentNode.removeChild(e)}function rn(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function b(e){return document.createElement(e)}function Oe(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function Qe(e){return document.createTextNode(e)}function k(){return Qe(" ")}function Mi(){return Qe("")}function N(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function p(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function kt(e,t,n){e.setAttributeNS("http://www.w3.org/1999/xlink",t,n)}function $i(e){return e===""?null:+e}function Or(e){return Array.from(e.childNodes)}function gn(e,t){t=""+t,e.data!==t&&(e.data=t)}function Ge(e,t){e.value=t??""}function Le(e,t,n,o){n==null?e.style.removeProperty(t):e.style.setProperty(t,n,o?"important":"")}function ln(e,t,n){for(let o=0;o<e.options.length;o+=1){const i=e.options[o];if(i.__value===t){i.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function Hi(e){const t=e.querySelector(":checked");return t&&t.__value}class Er{constructor(t=!1){$(this,"is_svg",!1);$(this,"e");$(this,"n");$(this,"t");$(this,"a");this.is_svg=t,this.e=this.n=null}c(t){this.h(t)}m(t,n,o=null){this.e||(this.is_svg?this.e=Oe(n.nodeName):this.e=b(n.nodeType===11?"TEMPLATE":n.nodeName),this.t=n.tagName!=="TEMPLATE"?n:n.content,this.c(t)),this.i(o)}h(t){this.e.innerHTML=t,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(t){for(let n=0;n<this.n.length;n+=1)M(this.t,this.n[n],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(j)}}let qt;function Rt(e){qt=e}function Vi(){if(!qt)throw new Error("Function called outside component initialization");return qt}function Ar(e){Vi().$$.on_mount.push(e)}function Pr(e){Vi().$$.on_destroy.push(e)}const wt=[],It=[];let vt=[];const Jo=[],Br=Promise.resolve();let Mn=!1;function Cr(){Mn||(Mn=!0,Br.then(zi))}function Lt(e){vt.push(e)}const xn=new Set;let yt=0;function zi(){if(yt!==0)return;const e=qt;do{try{for(;yt<wt.length;){const t=wt[yt];yt++,Rt(t),xr(t.$$)}}catch(t){throw wt.length=0,yt=0,t}for(Rt(null),wt.length=0,yt=0;It.length;)It.pop()();for(let t=0;t<vt.length;t+=1){const n=vt[t];xn.has(n)||(xn.add(n),n())}vt.length=0}while(wt.length);for(;Jo.length;)Jo.pop()();Mn=!1,xn.clear(),Rt(e)}function xr(e){if(e.fragment!==null){e.update(),re(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Lt)}}function Rr(e){const t=[],n=[];vt.forEach(o=>e.indexOf(o)===-1?t.push(o):n.push(o)),n.forEach(o=>o()),vt=t}const sn=new Set;let ot;function Nr(){ot={r:0,c:[],p:ot}}function Dr(){ot.r||re(ot.c),ot=ot.p}function I(e,t){e&&e.i&&(sn.delete(e),e.i(t))}function L(e,t,n,o){if(e&&e.o){if(sn.has(e))return;sn.add(e),ot.c.push(()=>{sn.delete(e),o&&(n&&e.d(1),o())}),e.o(t)}else o&&o()}function Je(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function K(e){e&&e.c()}function H(e,t,n){const{fragment:o,after_update:i}=e.$$;o&&o.m(t,n),Lt(()=>{const s=e.$$.on_mount.map(Ui).filter($t);e.$$.on_destroy?e.$$.on_destroy.push(...s):re(s),e.$$.on_mount=[]}),i.forEach(Lt)}function V(e,t){const n=e.$$;n.fragment!==null&&(Rr(n.after_update),re(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function qr(e,t){e.$$.dirty[0]===-1&&(wt.push(e),Cr(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Et(e,t,n,o,i,s,a=null,l=[-1]){const c=qt;Rt(e);const u=e.$$={fragment:null,ctx:[],props:s,update:se,not_equal:i,bound:Wo(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(c?c.$$.context:[])),callbacks:Wo(),dirty:l,skip_bound:!1,root:t.target||c.$$.root};a&&a(u.root);let r=!1;if(u.ctx=n?n(e,t.props||{},(g,w,...m)=>{const _=m.length?m[0]:w;return u.ctx&&i(u.ctx[g],u.ctx[g]=_)&&(!u.skip_bound&&u.bound[g]&&u.bound[g](_),r&&qr(e,g)),w}):[],u.update(),r=!0,re(u.before_update),u.fragment=o?o(u.ctx):!1,t.target){if(t.hydrate){const g=Or(t.target);u.fragment&&u.fragment.l(g),g.forEach(j)}else u.fragment&&u.fragment.c();t.intro&&I(e.$$.fragment),H(e,t.target,t.anchor),zi()}Rt(c)}class At{constructor(){$(this,"$$");$(this,"$$set")}$destroy(){V(this,1),this.$destroy=se}$on(t,n){if(!$t(n))return se;const o=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return o.push(n),()=>{const i=o.indexOf(n);i!==-1&&o.splice(i,1)}}$set(t){this.$$set&&!Sr(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Ir="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Ir);function Go(e,t,n){const o=e.slice();return o[10]=t[n][0],o[11]=t[n][1],o}function Lr(e){let t,n,o,i,s,a=e[2].text+"",l,c,u;return{c(){t=b("button"),n=Oe("svg"),o=Oe("use"),s=k(),l=Qe(a),kt(o,"xlink:href",i=e[2].icon),p(t,"class","b3-button b3-button--outline fn__size200 fn__flex-center"),p(t,"id",e[3]),t.disabled=e[5]},m(r,g){M(r,t,g),d(t,n),d(n,o),d(t,s),d(t,l),c||(u=N(t,"click",function(){$t(e[4])&&e[4].apply(this,arguments)}),c=!0)},p(r,g){e=r,g&4&&i!==(i=e[2].icon)&&kt(o,"xlink:href",i),g&4&&a!==(a=e[2].text+"")&&gn(l,a),g&8&&p(t,"id",e[3]),g&32&&(t.disabled=e[5])},d(r){r&&j(t),c=!1,u()}}}function jr(e){let t,n,o,i=Je(Object.entries(e[2].options)),s=[];for(let a=0;a<i.length;a+=1)s[a]=Qo(Go(e,i,a));return{c(){t=b("select");for(let a=0;a<s.length;a+=1)s[a].c();p(t,"class","b3-select fn__flex-center fn__size200"),p(t,"id",e[3]),e[0]===void 0&&Lt(()=>e[9].call(t))},m(a,l){M(a,t,l);for(let c=0;c<s.length;c+=1)s[c]&&s[c].m(t,null);ln(t,e[0],!0),n||(o=[N(t,"change",e[9]),N(t,"change",e[6])],n=!0)},p(a,l){if(l&4){i=Je(Object.entries(a[2].options));let c;for(c=0;c<i.length;c+=1){const u=Go(a,i,c);s[c]?s[c].p(u,l):(s[c]=Qo(u),s[c].c(),s[c].m(t,null))}for(;c<s.length;c+=1)s[c].d(1);s.length=i.length}l&8&&p(t,"id",a[3]),l&5&&ln(t,a[0])},d(a){a&&j(t),rn(s,a),n=!1,re(o)}}}function Fr(e){let t,n,o;return{c(){t=b("input"),p(t,"class","b3-switch fn__flex-center"),p(t,"id",e[3]),p(t,"type","checkbox")},m(i,s){M(i,t,s),t.checked=e[0],n||(o=[N(t,"change",e[8]),N(t,"change",e[6])],n=!0)},p(i,s){s&8&&p(t,"id",i[3]),s&5&&(t.checked=i[0])},d(i){i&&j(t),n=!1,re(o)}}}function Ur(e){let t,n,o,i,s,a,l;return{c(){t=b("div"),n=b("input"),p(n,"class","b3-slider fn__size200"),p(n,"id",e[3]),p(n,"type","range"),p(n,"min",o=e[2].min),p(n,"max",i=e[2].max),p(n,"step",s=e[2].step),p(t,"class","b3-tooltips b3-tooltips__n fn__flex-center"),p(t,"aria-label",e[0])},m(c,u){M(c,t,u),d(t,n),Ge(n,e[0]),a||(l=[N(n,"change",e[7]),N(n,"input",e[7]),N(n,"change",e[6])],a=!0)},p(c,u){u&8&&p(n,"id",c[3]),u&4&&o!==(o=c[2].min)&&p(n,"min",o),u&4&&i!==(i=c[2].max)&&p(n,"max",i),u&4&&s!==(s=c[2].step)&&p(n,"step",s),u&5&&Ge(n,c[0]),u&5&&p(t,"aria-label",c[0])},d(c){c&&j(t),a=!1,re(l)}}}function Qo(e){let t,n=e[11]+"",o,i;return{c(){t=b("option"),o=Qe(n),t.__value=i=e[10],Ge(t,t.__value)},m(s,a){M(s,t,a),d(t,o)},p(s,a){a&4&&n!==(n=s[11]+"")&&gn(o,n),a&4&&i!==(i=s[10])&&(t.__value=i,Ge(t,t.__value))},d(s){s&&j(t)}}}function Mr(e){let t,n,o,i=e[2].title+"",s,a,l=e[2].content+"",c,u,r;function g(_,E){if(_[1]==="range")return Ur;if(_[1]==="switch")return Fr;if(_[1]==="select")return jr;if(_[1]==="button")return Lr}let w=g(e),m=w&&w(e);return{c(){t=b("label"),n=b("div"),o=new Er(!1),s=k(),a=b("div"),c=k(),u=b("span"),r=k(),m&&m.c(),o.a=s,p(a,"class","b3-label__text"),p(n,"class","fn__flex-1"),p(u,"class","fn__space"),p(t,"class","fn__flex b3-label config__item")},m(_,E){M(_,t,E),d(t,n),o.m(i,n),d(n,s),d(n,a),a.innerHTML=l,d(t,c),d(t,u),d(t,r),m&&m.m(t,null)},p(_,[E]){E&4&&i!==(i=_[2].title+"")&&o.p(i),E&4&&l!==(l=_[2].content+"")&&(a.innerHTML=l),w===(w=g(_))&&m?m.p(_,E):(m&&m.d(1),m=w&&w(_),m&&(m.c(),m.m(t,null)))},i:se,o:se,d(_){_&&j(t),m&&m.d()}}}function $r(e,t,n){let{type:o}=t,{content:i}=t,{settingKey:s}=t,{settingValue:a}=t,{onMyClick:l=function(){}}=t,{disabled:c=null}=t;function u(){y.set(s,a),y.save()}function r(){a=$i(this.value),n(0,a),n(2,i)}function g(){a=this.checked,n(0,a),n(2,i)}function w(){a=Hi(this),n(0,a),n(2,i)}return e.$$set=m=>{"type"in m&&n(1,o=m.type),"content"in m&&n(2,i=m.content),"settingKey"in m&&n(3,s=m.settingKey),"settingValue"in m&&n(0,a=m.settingValue),"onMyClick"in m&&n(4,l=m.onMyClick),"disabled"in m&&n(5,c=m.disabled)},[a,o,i,s,l,c,u,r,g,w]}class he extends At{constructor(t){super(),Et(this,t,$r,Mr,Ot,{type:1,content:2,settingKey:3,settingValue:0,onMyClick:4,disabled:5})}}function Yo(e,t,n){const o=e.slice();return o[9]=t[n][0],o[10]=t[n][1],o}function Hr(e){let t,n,o,i=Je(Object.entries(e[2].options)),s=[];for(let a=0;a<i.length;a+=1)s[a]=Xo(Yo(e,i,a));return{c(){t=b("select");for(let a=0;a<s.length;a+=1)s[a].c();p(t,"class","b3-select fn__flex-center fn__size200"),p(t,"id",e[3]),e[0]===void 0&&Lt(()=>e[8].call(t))},m(a,l){M(a,t,l);for(let c=0;c<s.length;c+=1)s[c]&&s[c].m(t,null);ln(t,e[0],!0),n||(o=[N(t,"change",e[8]),N(t,"change",e[4])],n=!0)},p(a,l){if(l&4){i=Je(Object.entries(a[2].options));let c;for(c=0;c<i.length;c+=1){const u=Yo(a,i,c);s[c]?s[c].p(u,l):(s[c]=Xo(u),s[c].c(),s[c].m(t,null))}for(;c<s.length;c+=1)s[c].d(1);s.length=i.length}l&8&&p(t,"id",a[3]),l&5&&ln(t,a[0])},d(a){a&&j(t),rn(s,a),n=!1,re(o)}}}function Vr(e){let t,n,o;return{c(){t=b("input"),p(t,"class","b3-switch fn__flex-center"),p(t,"id",e[3]),p(t,"type","checkbox")},m(i,s){M(i,t,s),t.checked=e[0],n||(o=[N(t,"change",e[7]),N(t,"change",e[4])],n=!0)},p(i,s){s&8&&p(t,"id",i[3]),s&5&&(t.checked=i[0])},d(i){i&&j(t),n=!1,re(o)}}}function zr(e){let t,n,o,i,s,a,l;return{c(){t=b("div"),n=b("input"),p(n,"class","b3-slider fn__size200"),p(n,"id",e[3]),p(n,"type","range"),p(n,"min",o=e[2].min),p(n,"max",i=e[2].max),p(n,"step",s=e[2].step),p(t,"class","b3-tooltips b3-tooltips__n fn__flex-center"),p(t,"aria-label",e[0])},m(c,u){M(c,t,u),d(t,n),Ge(n,e[0]),a||(l=[N(n,"change",e[6]),N(n,"input",e[6]),N(n,"change",e[4])],a=!0)},p(c,u){u&8&&p(n,"id",c[3]),u&4&&o!==(o=c[2].min)&&p(n,"min",o),u&4&&i!==(i=c[2].max)&&p(n,"max",i),u&4&&s!==(s=c[2].step)&&p(n,"step",s),u&5&&Ge(n,c[0]),u&5&&p(t,"aria-label",c[0])},d(c){c&&j(t),a=!1,re(l)}}}function Xo(e){let t,n=e[10]+"",o,i;return{c(){t=b("option"),o=Qe(n),t.__value=i=e[9],Ge(t,t.__value)},m(s,a){M(s,t,a),d(t,o)},p(s,a){a&4&&n!==(n=s[10]+"")&&gn(o,n),a&4&&i!==(i=s[9])&&(t.__value=i,Ge(t,t.__value))},d(s){s&&j(t)}}}function Kr(e){let t,n,o=e[2].title+"",i,s;function a(u,r){if(u[1]==="range")return zr;if(u[1]==="switch")return Vr;if(u[1]==="select")return Hr}let l=a(e),c=l&&l(e);return{c(){t=b("div"),n=b("div"),i=Qe(o),s=k(),c&&c.c(),p(n,"class","fn__flex-1 fn__flex-center"),p(t,"class","fn__flex")},m(u,r){M(u,t,r),d(t,n),d(n,i),d(t,s),c&&c.m(t,null)},p(u,[r]){r&4&&o!==(o=u[2].title+"")&&gn(i,o),l===(l=a(u))&&c?c.p(u,r):(c&&c.d(1),c=l&&l(u),c&&(c.c(),c.m(t,null)))},i:se,o:se,d(u){u&&j(t),c&&c.d()}}}function Wr(e,t,n){let{type:o}=t,{content:i}=t,{settingKey:s}=t,{settingValue:a}=t,{name:l}=t;function c(){y.set(s,a,l),y.save(l)}function u(){a=$i(this.value),n(0,a),n(2,i)}function r(){a=this.checked,n(0,a),n(2,i)}function g(){a=Hi(this),n(0,a),n(2,i)}return e.$$set=w=>{"type"in w&&n(1,o=w.type),"content"in w&&n(2,i=w.content),"settingKey"in w&&n(3,s=w.settingKey),"settingValue"in w&&n(0,a=w.settingValue),"name"in w&&n(5,l=w.name)},[a,o,i,s,c,l,u,r,g]}class nt extends At{constructor(t){super(),Et(this,t,Wr,Kr,Ot,{type:1,content:2,settingKey:3,settingValue:0,name:5})}}class Jr{constructor(){$(this,"events");this.events={}}on(t,n){this.events[t]||(this.events[t]=[]),this.events[t].push(n)}off(t,n){if(!this.events[t])return;const o=this.events[t].indexOf(n);o>=0&&this.events[t].splice(o,1)}emit(t,...n){this.events[t]&&this.events[t].forEach(o=>{o.apply(this,n)})}once(t,n){function o(...i){n.apply(this,i),this.off(t,o)}this.on(t,o)}}let Ee=new Jr;function Gr(e){let t,n,o,i,s,a,l,c,u,r,g,w,m,_,E,D,S,X,Ne,De,Ae,Z,Ye,ee,le,J,ye,G,Fe,ce,ae,_e,Pe,ne,Xe,Q,Ue,ue,qe,Me,$e,oe,Be,pe,q;return X=new nt({props:{type:"select",content:v.settingsTab.items.listType,settingKey:"listType",settingValue:y.get("listType",e[0]),name:e[0]}}),Z=new nt({props:{type:"select",content:v.settingsTab.items.linkType,settingKey:"linkType",settingValue:y.get("linkType",e[0]),name:e[0]}}),J=new nt({props:{type:"switch",content:v.settingsTab.items.icon,settingKey:"icon",settingValue:y.get("icon",e[0]),name:e[0]}}),ce=new nt({props:{type:"range",content:v.settingsTab.items.depth,settingKey:"depth",settingValue:y.get("depth",e[0]),name:e[0]}}),ne=new nt({props:{type:"range",content:v.settingsTab.items.fold,settingKey:"fold",settingValue:y.get("fold",e[0]),name:e[0]}}),ue=new nt({props:{type:"range",content:v.settingsTab.items.col,settingKey:"col",settingValue:y.get("col",e[0]),name:e[0]}}),oe=new nt({props:{type:"switch",content:v.settingsTab.items.autoUpdate,settingKey:"autoUpdate",settingValue:y.get("autoUpdate",e[0]),name:e[0]}}),{c(){t=b("label"),n=b("div"),o=b("div"),o.textContent=`${e[2]}`,i=k(),s=b("div"),a=k(),l=b("span"),l.innerHTML='<svg><use xlink:href="#iconSelect"></use></svg>',c=k(),u=b("div"),r=k(),g=b("span"),g.innerHTML='<svg><use xlink:href="#iconTrashcan"></use></svg>',w=k(),m=b("div"),_=k(),E=b("div"),D=k(),S=b("div"),K(X.$$.fragment),Ne=k(),De=b("div"),Ae=k(),K(Z.$$.fragment),Ye=k(),ee=b("div"),le=k(),K(J.$$.fragment),ye=k(),G=b("div"),Fe=k(),K(ce.$$.fragment),ae=k(),_e=b("div"),Pe=k(),K(ne.$$.fragment),Xe=k(),Q=b("div"),Ue=k(),K(ue.$$.fragment),qe=k(),Me=b("div"),$e=k(),K(oe.$$.fragment),Le(o,"font-weight","bold"),Le(o,"font-size","16px"),p(s,"class","fn__flex-1 fn__space"),p(l,"class","b3-tooltips b3-tooltips__sw block__icon block__icon--show"),p(l,"data-type","switch"),p(l,"aria-label",v.useTemplate),p(u,"class","fn__space"),p(g,"aria-label",v.deleteTemplate),p(g,"class","b3-tooltips b3-tooltips__sw block__icon block__icon--show"),p(n,"class","fn__flex"),p(m,"class","fn__hr"),p(E,"class","fn__hr"),p(De,"class","fn__hr"),p(ee,"class","fn__hr"),p(G,"class","fn__hr"),p(_e,"class","fn__hr"),p(Q,"class","fn__hr"),p(Me,"class","fn__hr"),p(S,"class","fn_flex"),Le(S,"flex-direction","column"),p(t,"class","fn__flex b3-label config__item"),Le(t,"flex-direction","column"),p(t,"id",e[0])},m(O,F){M(O,t,F),d(t,n),d(n,o),d(n,i),d(n,s),d(n,a),d(n,l),d(n,c),d(n,u),d(n,r),d(n,g),d(t,w),d(t,m),d(t,_),d(t,E),d(t,D),d(t,S),H(X,S,null),d(S,Ne),d(S,De),d(S,Ae),H(Z,S,null),d(S,Ye),d(S,ee),d(S,le),H(J,S,null),d(S,ye),d(S,G),d(S,Fe),H(ce,S,null),d(S,ae),d(S,_e),d(S,Pe),H(ne,S,null),d(S,Xe),d(S,Q),d(S,Ue),H(ue,S,null),d(S,qe),d(S,Me),d(S,$e),H(oe,S,null),e[5](t),Be=!0,pe||(q=[N(l,"click",e[4]),N(g,"click",e[3])],pe=!0)},p(O,[F]){const A={};F&1&&(A.settingValue=y.get("listType",O[0])),F&1&&(A.name=O[0]),X.$set(A);const we={};F&1&&(we.settingValue=y.get("linkType",O[0])),F&1&&(we.name=O[0]),Z.$set(we);const ie={};F&1&&(ie.settingValue=y.get("icon",O[0])),F&1&&(ie.name=O[0]),J.$set(ie);const it={};F&1&&(it.settingValue=y.get("depth",O[0])),F&1&&(it.name=O[0]),ce.$set(it);const ke={};F&1&&(ke.settingValue=y.get("fold",O[0])),F&1&&(ke.name=O[0]),ne.$set(ke);const st={};F&1&&(st.settingValue=y.get("col",O[0])),F&1&&(st.name=O[0]),ue.$set(st);const ve={};F&1&&(ve.settingValue=y.get("autoUpdate",O[0])),F&1&&(ve.name=O[0]),oe.$set(ve),(!Be||F&1)&&p(t,"id",O[0])},i(O){Be||(I(X.$$.fragment,O),I(Z.$$.fragment,O),I(J.$$.fragment,O),I(ce.$$.fragment,O),I(ne.$$.fragment,O),I(ue.$$.fragment,O),I(oe.$$.fragment,O),Be=!0)},o(O){L(X.$$.fragment,O),L(Z.$$.fragment,O),L(J.$$.fragment,O),L(ce.$$.fragment,O),L(ne.$$.fragment,O),L(ue.$$.fragment,O),L(oe.$$.fragment,O),Be=!1},d(O){O&&j(t),V(X),V(Z),V(J),V(ce),V(ne),V(ue),V(oe),e[5](null),pe=!1,re(q)}}}function Qr(e,t,n){let{name:o}=t,i,s=o.substring(15);function a(){y.remove(o),i.parentNode.remove(),Ee.emit("addTemplateIndexNone")}async function l(){y.saveTo(o),me.showMessage(v.templateUsed,3e3,"info")}function c(u){It[u?"unshift":"push"](()=>{i=u,n(1,i)})}return e.$$set=u=>{"name"in u&&n(0,o=u.name)},[o,i,s,a,l,c]}class Ki extends At{constructor(t){super(),Et(this,t,Qr,Gr,Ot,{name:0})}}function Yr(e){let t,n,o=v.nothasTemplate+"",i,s,a,l,c;return{c(){t=b("div"),n=b("div"),i=Qe(o),s=k(),a=b("a"),a.textContent=`${v.cliketoAdd}`,p(n,"class","b3-label b3-label--inner"),p(t,"class","b3-label")},m(u,r){M(u,t,r),d(t,n),d(n,i),d(n,s),d(n,a),l||(c=N(a,"click",e[1]),l=!0)},p:se,i:se,o:se,d(u){u&&j(t),l=!1,c()}}}function Xr(e,t,n){let{tab:o}=t;const i=()=>{Ee.emit("switchTab","normal",o),console.log("switchTab")};return e.$$set=s=>{"tab"in s&&n(0,o=s.tab)},[o,i]}class Zo extends At{constructor(t){super(),Et(this,t,Xr,Yr,Ot,{tab:0})}}function ei(e,t,n){const o=e.slice();return o[45]=t[n][0],o}function ti(e,t,n){const o=e.slice();return o[45]=t[n][0],o}function Zr(e){let t,n,o,i;return n=new Ki({props:{name:e[45]}}),{c(){t=b("div"),K(n.$$.fragment),o=k()},m(s,a){M(s,t,a),H(n,t,null),d(t,o),i=!0},p:se,i(s){i||(I(n.$$.fragment,s),i=!0)},o(s){L(n.$$.fragment,s),i=!1},d(s){s&&j(t),V(n)}}}function ni(e){let t=e[45]!="config"&&e[45].indexOf("index")!=-1,n,o,i=t&&Zr(e);return{c(){i&&i.c(),n=Mi()},m(s,a){i&&i.m(s,a),M(s,n,a),o=!0},p(s,a){t&&i.p(s,a)},i(s){o||(I(i),o=!0)},o(s){L(i),o=!1},d(s){s&&j(n),i&&i.d(s)}}}function el(e){let t;return{c(){t=b("div"),t.innerHTML=""},m(n,o){M(n,t,o)},d(n){n&&j(t)}}}function oi(e){let t=e[45]!="config"&&e[45].indexOf("outline")!=-1,n,o=t&&el();return{c(){o&&o.c(),n=Mi()},m(i,s){o&&o.m(i,s),M(i,n,s)},p:se,d(i){i&&j(n),o&&o.d(i)}}}function tl(e){let t,n,o,i,s,a,l,c,u,r,g,w,m,_,E,D,S,X,Ne,De,Ae,Z,Ye,ee,le,J,ye,G,Fe,ce,ae,_e,Pe,ne,Xe,Q,Ue,ue,qe,Me,$e,oe,Be,pe,q,O,F,A,we,ie,it,ke,st,ve,eo,Ze,to,at,no,Pt,rt,bn,oo,He,yn,_n,io,Qi=v.settingsTab.items.createTemplate+"",so,Ht,ao,fe,lt,ro,ct,lo,ut,co,pt,Vt,zt,uo,ft,et,dt,Te,wn,po,Kt,fo,kn,Wt,ho,Se,vn,mo,Jt,go,Tn,Gt,bo,ht,Ve,Qt,yo,ze,Yt,Xt,_o,mt,gt,Zt,W,Sn,wo;O=new he({props:{type:"select",content:v.settingsTab.items.listType,settingKey:"listType",settingValue:e[6]}}),A=new he({props:{type:"select",content:v.settingsTab.items.linkType,settingKey:"linkType",settingValue:e[7]}}),ie=new he({props:{type:"switch",content:v.settingsTab.items.icon,settingKey:"icon",settingValue:e[4]}}),ke=new he({props:{type:"range",content:v.settingsTab.items.depth,settingKey:"depth",settingValue:e[5]}}),ve=new he({props:{type:"range",content:v.settingsTab.items.fold,settingKey:"fold",settingValue:e[9]}}),Ze=new he({props:{type:"range",content:v.settingsTab.items.col,settingKey:"col",settingValue:e[8]}}),at=new he({props:{type:"switch",content:v.settingsTab.items.autoUpdate,settingKey:"autoUpdate",settingValue:e[14]}}),lt=new he({props:{type:"select",content:v.settingsTab.items.listTypeOutline,settingKey:"listType",settingValue:e[18]}}),ct=new he({props:{type:"switch",content:v.settingsTab.items.at,settingKey:"at",settingValue:e[15]}}),ut=new he({props:{type:"select",content:v.settingsTab.items.outlineType,settingKey:"outlineType",settingValue:e[16]}}),pt=new he({props:{type:"switch",content:v.settingsTab.items.outlineAutoUpdate,settingKey:"outlineAutoUpdate",settingValue:e[17]}});let tt=Je(Object.entries(x.data)),U=[];for(let T=0;T<tt.length;T+=1)U[T]=ni(ti(e,tt,T));const Yi=T=>L(U[T],1,1,()=>{U[T]=null});let bt=Je(Object.entries(x.data)),te=[];for(let T=0;T<bt.length;T+=1)te[T]=oi(ei(e,bt,T));return gt=new he({props:{type:"switch",content:v.settingsTab.items.docBuilder,settingKey:"docBuilder",settingValue:e[13]}}),{c(){t=b("div"),n=b("ul"),o=b("li"),i=Oe("svg"),s=Oe("use"),a=k(),l=b("span"),l.textContent=`${v.generalSettings}`,u=k(),r=b("li"),g=Oe("svg"),w=Oe("use"),m=k(),_=b("span"),_.textContent=`${v.templateSettings}`,D=k(),S=b("li"),X=Oe("svg"),Ne=Oe("use"),De=k(),Ae=b("span"),Ae.textContent=`${v.extraSettings}`,Ye=k(),ee=b("div"),le=b("div"),J=b("div"),ye=b("div"),G=b("div"),Fe=b("span"),ce=k(),ae=b("span"),ae.textContent=`${v.indexSettings}`,_e=k(),Pe=b("span"),Xe=k(),Q=b("div"),Ue=b("span"),ue=k(),qe=b("span"),qe.textContent=`${v.outlineSettings}`,Me=k(),$e=b("span"),Be=k(),pe=b("div"),q=b("div"),K(O.$$.fragment),F=k(),K(A.$$.fragment),we=k(),K(ie.$$.fragment),it=k(),K(ke.$$.fragment),st=k(),K(ve.$$.fragment),eo=k(),K(Ze.$$.fragment),to=k(),K(at.$$.fragment),no=k(),Pt=b("label"),rt=b("div"),bn=b("div"),oo=k(),He=b("button"),yn=Oe("svg"),_n=Oe("use"),io=k(),so=Qe(Qi),ao=k(),fe=b("div"),K(lt.$$.fragment),ro=k(),K(ct.$$.fragment),lo=k(),K(ut.$$.fragment),co=k(),K(pt.$$.fragment),uo=k(),ft=b("div"),et=b("div"),dt=b("div"),Te=b("div"),wn=b("span"),po=k(),Kt=b("span"),Kt.textContent="",fo=k(),kn=b("span"),ho=k(),Se=b("div"),vn=b("span"),mo=k(),Jt=b("span"),Jt.textContent="",go=k(),Tn=b("span"),bo=k(),ht=b("div"),Ve=b("div");for(let T=0;T<U.length;T+=1)U[T].c();yo=k(),ze=b("div");for(let T=0;T<te.length;T+=1)te[T].c();_o=k(),mt=b("div"),K(gt.$$.fragment),kt(s,"xlink:href","#iconSettings"),p(i,"class","b3-list-item__graphic"),p(l,"class","b3-list-item__text"),p(o,"data-name","normal"),p(o,"class",c=e[10]==="normal"?"b3-list-item--focus b3-list-item":"b3-list-item"),kt(w,"xlink:href","#iconBazaar"),p(g,"class","b3-list-item__graphic"),p(_,"class","b3-list-item__text"),p(r,"data-name","template"),p(r,"class",E=e[10]==="template"?"b3-list-item--focus b3-list-item":"b3-list-item"),kt(Ne,"xlink:href","#iconSQL"),p(X,"class","b3-list-item__graphic"),p(Ae,"class","b3-list-item__text"),p(S,"data-name","extra"),p(S,"class",Z=e[10]==="extra"?"b3-list-item--focus b3-list-item":"b3-list-item"),p(n,"class","b3-tab-bar b3-list b3-list--background"),p(Fe,"class","fn__flex-1"),p(ae,"class","item__text"),p(Pe,"class","fn__flex-1"),p(G,"data-name","indexSettings"),p(G,"class",ne=e[11]==="indexSettings"?"item item--full item--focus":"item item--full"),p(Ue,"class","fn__flex-1"),p(qe,"class","item__text"),p($e,"class","fn__flex-1"),p(Q,"data-name","outlineSettings"),p(Q,"class",oe=e[11]==="outlineSettings"?"item item--full item--focus":"item item--full"),p(ye,"class","layout-tab-bar fn__flex"),p(bn,"class","fn__flex-1"),kt(_n,"xlink:href","#iconAdd"),p(He,"class","b3-button b3-button--outline fn__flex-center fn__size200"),p(He,"id","createtemplate"),p(rt,"class","fn__flex"),p(Pt,"class","fn__flex b3-label config__item"),Le(Pt,"flex-direction","column"),p(q,"data-name","indexSettings"),p(q,"class",Ht=e[11]==="indexSettings"?"config__tab-container":"config__tab-container fn__none"),p(fe,"data-name","outlineSettings"),p(fe,"class",Vt=e[11]==="outlineSettings"?"config__tab-container":"config__tab-container fn__none"),p(pe,"class","fn__flex-1"),p(J,"class","fn__flex-column"),Le(J,"height","100%"),p(le,"data-name","normal"),p(le,"class",zt=e[10]==="normal"?"config__tab-container":"config__tab-container fn__none"),p(wn,"class","fn__flex-1"),p(Kt,"class","item__text"),p(kn,"class","fn__flex-1"),p(Te,"data-name","indexTemplate"),p(Te,"class",Wt=e[12]==="indexTemplate"?"item item--full item--focus":"item item--full"),p(vn,"class","fn__flex-1"),p(Jt,"class","item__text"),p(Tn,"class","fn__flex-1"),p(Se,"data-name","outlineTemplate"),p(Se,"class",Gt=e[12]==="outlineTemplate"?"item item--full item--focus":"item item--full"),p(dt,"class","layout-tab-bar fn__flex"),p(Ve,"data-name","indexTemplate"),p(Ve,"class",Qt=e[12]==="indexTemplate"?"config__tab-container":"config__tab-container fn__none"),p(ze,"data-name","outlineTemplate"),p(ze,"class",Yt=e[12]==="outlineTemplate"?"config__tab-container":"config__tab-container fn__none"),p(ht,"class","fn__flex-1"),p(et,"class","fn__flex-column"),Le(et,"height","100%"),p(ft,"data-name","template"),p(ft,"class",Xt=e[10]==="template"?"config__tab-container":"config__tab-container fn__none"),p(mt,"data-name","extra"),p(mt,"class",Zt=e[10]==="extra"?"config__tab-container":"config__tab-container fn__none"),p(ee,"class","config__tab-wrap"),p(t,"class","fn__flex-1 fn__flex config__panel")},m(T,P){M(T,t,P),d(t,n),d(n,o),d(o,i),d(i,s),d(o,a),d(o,l),d(n,u),d(n,r),d(r,g),d(g,w),d(r,m),d(r,_),d(n,D),d(n,S),d(S,X),d(X,Ne),d(S,De),d(S,Ae),d(t,Ye),d(t,ee),d(ee,le),d(le,J),d(J,ye),d(ye,G),d(G,Fe),d(G,ce),d(G,ae),d(G,_e),d(G,Pe),d(ye,Xe),d(ye,Q),d(Q,Ue),d(Q,ue),d(Q,qe),d(Q,Me),d(Q,$e),d(J,Be),d(J,pe),d(pe,q),H(O,q,null),d(q,F),H(A,q,null),d(q,we),H(ie,q,null),d(q,it),H(ke,q,null),d(q,st),H(ve,q,null),d(q,eo),H(Ze,q,null),d(q,to),H(at,q,null),d(q,no),d(q,Pt),d(Pt,rt),d(rt,bn),d(rt,oo),d(rt,He),d(He,yn),d(yn,_n),d(He,io),d(He,so),d(pe,ao),d(pe,fe),H(lt,fe,null),d(fe,ro),H(ct,fe,null),d(fe,lo),H(ut,fe,null),d(fe,co),H(pt,fe,null),d(ee,uo),d(ee,ft),d(ft,et),d(et,dt),d(dt,Te),d(Te,wn),d(Te,po),d(Te,Kt),d(Te,fo),d(Te,kn),d(dt,ho),d(dt,Se),d(Se,vn),d(Se,mo),d(Se,Jt),d(Se,go),d(Se,Tn),d(et,bo),d(et,ht),d(ht,Ve);for(let de=0;de<U.length;de+=1)U[de]&&U[de].m(Ve,null);e[26](Ve),d(ht,yo),d(ht,ze);for(let de=0;de<te.length;de+=1)te[de]&&te[de].m(ze,null);e[27](ze),d(ee,_o),d(ee,mt),H(gt,mt,null),W=!0,Sn||(wo=[N(o,"click",e[19]),N(r,"click",e[20]),N(S,"click",e[21]),N(G,"click",e[22]),N(Q,"click",e[23]),N(He,"click",function(){$t(e[0])&&e[0].apply(this,arguments)}),N(Te,"click",e[24]),N(Se,"click",e[25])],Sn=!0)},p(T,P){e=T,(!W||P[0]&1024&&c!==(c=e[10]==="normal"?"b3-list-item--focus b3-list-item":"b3-list-item"))&&p(o,"class",c),(!W||P[0]&1024&&E!==(E=e[10]==="template"?"b3-list-item--focus b3-list-item":"b3-list-item"))&&p(r,"class",E),(!W||P[0]&1024&&Z!==(Z=e[10]==="extra"?"b3-list-item--focus b3-list-item":"b3-list-item"))&&p(S,"class",Z),(!W||P[0]&2048&&ne!==(ne=e[11]==="indexSettings"?"item item--full item--focus":"item item--full"))&&p(G,"class",ne),(!W||P[0]&2048&&oe!==(oe=e[11]==="outlineSettings"?"item item--full item--focus":"item item--full"))&&p(Q,"class",oe);const de={};P[0]&64&&(de.settingValue=e[6]),O.$set(de);const ko={};P[0]&128&&(ko.settingValue=e[7]),A.$set(ko);const vo={};P[0]&16&&(vo.settingValue=e[4]),ie.$set(vo);const To={};P[0]&32&&(To.settingValue=e[5]),ke.$set(To);const So={};P[0]&512&&(So.settingValue=e[9]),ve.$set(So);const Oo={};if(P[0]&256&&(Oo.settingValue=e[8]),Ze.$set(Oo),(!W||P[0]&2048&&Ht!==(Ht=e[11]==="indexSettings"?"config__tab-container":"config__tab-container fn__none"))&&p(q,"class",Ht),(!W||P[0]&2048&&Vt!==(Vt=e[11]==="outlineSettings"?"config__tab-container":"config__tab-container fn__none"))&&p(fe,"class",Vt),(!W||P[0]&1024&&zt!==(zt=e[10]==="normal"?"config__tab-container":"config__tab-container fn__none"))&&p(le,"class",zt),(!W||P[0]&4096&&Wt!==(Wt=e[12]==="indexTemplate"?"item item--full item--focus":"item item--full"))&&p(Te,"class",Wt),(!W||P[0]&4096&&Gt!==(Gt=e[12]==="outlineTemplate"?"item item--full item--focus":"item item--full"))&&p(Se,"class",Gt),P&0){tt=Je(Object.entries(x.data));let R;for(R=0;R<tt.length;R+=1){const Bt=ti(e,tt,R);U[R]?(U[R].p(Bt,P),I(U[R],1)):(U[R]=ni(Bt),U[R].c(),I(U[R],1),U[R].m(Ve,null))}for(Nr(),R=tt.length;R<U.length;R+=1)Yi(R);Dr()}if((!W||P[0]&4096&&Qt!==(Qt=e[12]==="indexTemplate"?"config__tab-container":"config__tab-container fn__none"))&&p(Ve,"class",Qt),P&0){bt=Je(Object.entries(x.data));let R;for(R=0;R<bt.length;R+=1){const Bt=ei(e,bt,R);te[R]?te[R].p(Bt,P):(te[R]=oi(Bt),te[R].c(),te[R].m(ze,null))}for(;R<te.length;R+=1)te[R].d(1);te.length=bt.length}(!W||P[0]&4096&&Yt!==(Yt=e[12]==="outlineTemplate"?"config__tab-container":"config__tab-container fn__none"))&&p(ze,"class",Yt),(!W||P[0]&1024&&Xt!==(Xt=e[10]==="template"?"config__tab-container":"config__tab-container fn__none"))&&p(ft,"class",Xt),(!W||P[0]&1024&&Zt!==(Zt=e[10]==="extra"?"config__tab-container":"config__tab-container fn__none"))&&p(mt,"class",Zt)},i(T){if(!W){I(O.$$.fragment,T),I(A.$$.fragment,T),I(ie.$$.fragment,T),I(ke.$$.fragment,T),I(ve.$$.fragment,T),I(Ze.$$.fragment,T),I(at.$$.fragment,T),I(lt.$$.fragment,T),I(ct.$$.fragment,T),I(ut.$$.fragment,T),I(pt.$$.fragment,T);for(let P=0;P<tt.length;P+=1)I(U[P]);I(gt.$$.fragment,T),W=!0}},o(T){L(O.$$.fragment,T),L(A.$$.fragment,T),L(ie.$$.fragment,T),L(ke.$$.fragment,T),L(ve.$$.fragment,T),L(Ze.$$.fragment,T),L(at.$$.fragment,T),L(lt.$$.fragment,T),L(ct.$$.fragment,T),L(ut.$$.fragment,T),L(pt.$$.fragment,T),U=U.filter(Boolean);for(let P=0;P<U.length;P+=1)L(U[P]);L(gt.$$.fragment,T),W=!1},d(T){T&&j(t),V(O),V(A),V(ie),V(ke),V(ve),V(Ze),V(at),V(lt),V(ct),V(ut),V(pt),rn(U,T),e[26](null),rn(te,T),e[27](null),V(gt),Sn=!1,re(wo)}}}function nl(e,t,n){let{onCreateTemplateButton:o}=t,{onGetIndexTemplate:i}=t,s,a,l=y.get("icon"),c=y.get("depth"),u=y.get("listType"),r=y.get("linkType"),g=y.get("docBuilder"),w=y.get("col"),m=y.get("fold"),_=y.get("autoUpdate"),E=y.get("at"),D=y.get("outlineType"),S=y.get("outlineAutoUpdate"),X=y.get("listTypeOutline"),Ne=l??!0,De=c??0,Ae=u??"unordered",Z=r??"ref",Ye=g??!1,ee=w??1,le=m??0,J=l==null?!0:_,ye=E??!0,G=D??"ref",Fe=S??!1,ce=X==null?"unordered":u,ae="normal",_e="indexSettings",Pe="indexTemplate";async function ne(){await y.load(),n(4,Ne=y.get("icon")),n(5,De=y.get("depth")),n(6,Ae=y.get("listType")),n(7,Z=y.get("linkType")),n(8,ee=y.get("col")),n(9,le=y.get("fold"))}Ee.on("updateSettings",ne);function Xe(A){let we=document.getElementById("templateIndexnone");we&&we.remove();let ie=document.createElement("div");new Ki({target:ie,props:{name:A}}),s.appendChild(ie)}Ee.on("addTemplateIndex",Xe);function Q(A,we){n(10,ae=A),n(11,_e=we)}Ee.on("switchTab",Q);function Ue(){if(console.log(s.children.length),s.children.length==0){let A=document.createElement("div");A.id="templateIndexnone",new Zo({target:A,props:{tab:"indexSettings"}}),s.appendChild(A)}}function ue(){if(console.log(a.children.length),a.children.length==0){let A=document.createElement("div");A.id="templateoutlinenone",new Zo({target:A,props:{tab:"outlineSettings"}}),a.appendChild(A)}}Ee.on("addTemplateIndexNone",Ue),Ee.on("addTemplateOutlineNone",ue),Ar(()=>{Ee.emit("addTemplateIndexNone"),Ee.emit("addTemplateOutlineNone")}),Pr(()=>{y.save()});const qe=()=>{n(10,ae="normal"),Ee.emit("updateSettings")},Me=()=>{n(10,ae="template"),i()},$e=()=>n(10,ae="extra"),oe=()=>{n(11,_e="indexSettings")},Be=()=>{n(11,_e="outlineSettings")},pe=()=>{n(12,Pe="indexTemplate")},q=()=>{n(12,Pe="outlineTemplate")};function O(A){It[A?"unshift":"push"](()=>{s=A,n(2,s)})}function F(A){It[A?"unshift":"push"](()=>{a=A,n(3,a)})}return e.$$set=A=>{"onCreateTemplateButton"in A&&n(0,o=A.onCreateTemplateButton),"onGetIndexTemplate"in A&&n(1,i=A.onGetIndexTemplate)},[o,i,s,a,Ne,De,Ae,Z,ee,le,ae,_e,Pe,Ye,J,ye,G,Fe,ce,qe,Me,$e,oe,Be,pe,q,O,F]}class ol extends At{constructor(t){super(),Et(this,t,nl,tl,Ot,{onCreateTemplateButton:0,onGetIndexTemplate:1},null,[-1,-1])}}function il(e){let t,n,o,i,s,a;return{c(){t=b("label"),t.innerHTML='<div class="fn__flex-1"><input id="template-name" class="b3-text-field fn__flex-center fn__size200"/></div>',n=k(),o=b("div"),i=b("button"),i.textContent=`${v.settingsTab.items.templateDialog.save}`,p(t,"class","fn__flex b3-label config__item"),p(i,"id","saveDraw"),p(i,"class","b3-button"),p(o,"class","button-group"),Le(o,"float","right"),Le(o,"margin","20px 0 10px")},m(l,c){M(l,t,c),M(l,n,c),M(l,o,c),d(o,i),s||(a=N(i,"click",function(){$t(e[0])&&e[0].apply(this,arguments)}),s=!0)},p(l,[c]){e=l},i:se,o:se,d(l){l&&(j(t),j(n),j(o)),s=!1,a()}}}function sl(e,t,n){let{onSave:o=function(){}}=t;return e.$$set=i=>{"onSave"in i&&n(0,o=i.onSave)},[o]}class al extends At{constructor(t){super(),Et(this,t,sl,il,Ot,{onSave:0})}}async function rl(){ll()}function ll(){const e="index-get-template-name",t=new me.Dialog({title:v.settingsTab.items.templateDialog.title,content:`<div id="${e}" class="b3-dialog__content">`,width:"300px"});let n=t.element.querySelector(`#${e}`);new al({target:n,props:{onSave:()=>{cl(t)}}})}async function cl(e){let t=e.element.querySelector("#template-name");if(t.value==""){me.showMessage(v.templateNameEepty,3e3,"error");return}else{let o=(await me.fetchSyncPost("/api/file/readDir",{path:"/data/storage/petal/siyuan-plugins-index"})).data;for(const i of o)if(i.name.indexOf("template-index-"+t.value)!=-1){me.showMessage(v.templateAgain,3e3,"error");return}await y.saveCopy("template-index-"+t.value),Ee.emit("addTemplateIndex","template-index-"+t.value)}e.destroy(),me.showMessage(v.templateCreated,3e3,"info")}async function ii(){let t=(await me.fetchSyncPost("/api/file/readDir",{path:"/data/storage/petal/siyuan-plugins-index"})).data;for(const n of t)n.name.startsWith("template-index-")&&await y.load(n.name)}async function ul(){const e=x.addTopBar({icon:"iconList",title:v.addTopBarIcon,position:"right",callback:async()=>{Un()}});x.addCommand({langKey:"addTopBarIcon",hotkey:"I",callback:async()=>{Un()}}),x.addCommand({langKey:"insertSubIndexoutline",hotkey:"O",callback:async()=>{qi()}}),x.addCommand({langKey:"insertoutline",hotkey:"P",callback:async()=>{Ii()}}),e.addEventListener("contextmenu",async()=>{if(hn)si();else{let t=e.getBoundingClientRect();t.width===0&&(t=document.querySelector("#barMore").getBoundingClientRect()),t.width===0&&(t=document.querySelector("#barPlugins").getBoundingClientRect()),si(t)}})}async function Wi(){await y.load(),await ii();const e="index-settings";let n=new me.Dialog({title:v.settingsTab.name,content:`<div id="${e}" class="fn__flex-1 fn__flex config__panel">`,width:"70%",height:"70%"}).element.querySelector(`#${e}`);new ol({target:n,props:{onCreateTemplateButton:()=>rl(),onGetIndexTemplate:()=>ii()}})}function si(e){const t=new me.Menu;t.addItem({icon:"iconList",label:v.insertIndex,accelerator:x.commands[0].customHotkey,click:()=>{Un()}}),t.addItem({icon:"iconAlignLeft",label:v.insertSubIndexoutline,accelerator:x.commands[1].customHotkey,click:()=>{qi()}}),t.addItem({icon:"iconAlignCenter",label:v.insertoutline,accelerator:x.commands[2].customHotkey,click:()=>{Ii()}}),t.addSeparator(),t.addItem({icon:"iconSettings",label:v.settings,click:async()=>{await Wi()}}),hn?t.fullscreen():t.open({x:e.right,y:e.bottom,isLeft:!0})}let We;function ai({detail:e}){e.blockElements.length>1||e.blockElements[0].getAttribute("data-type")!="NodeList"||!y.get("docBuilder")||e.menu.addItem({icon:"iconList",label:v.settingsTab.items.docBuilder.title,click:async()=>{await pl(e)}})}async function pl(e){We=new Qn,We.notebookId=e.protyle.notebookId;let t=e.blockElements[0].getAttribute("data-node-id"),n=e.blockElements[0].childNodes;We.basePath=await fl(t);let o=await C.getBlockInfo({id:e.protyle.block.rootID});We.pPath=o.data.path.slice(0,-3),await Ji(n,We),await Gi(We),await wr(We.notebookId,t,o.data.path)}async function Ji(e,t,n=0){n++;let o;for(const i of e)if(i.getAttribute("data-type")=="NodeListItem"){let s=i.childNodes;for(const a of s)if(a.getAttribute("data-type")=="NodeParagraph"){let l=window.Lute.BlockDOM2Content(a.innerHTML),c=new _r(n,l);t.push(c),o=c.children}else a.getAttribute("data-type")=="NodeList"&&await Ji(a.childNodes,o,n)}}async function fl(e){let n=(await C.sql({stmt:`SELECT * FROM blocks WHERE id = '${e}'`})).data[0];return n==null?void 0:n.hpath}async function dl(e,t){return(await C.createDocWithMd({markdown:"",notebook:e,path:t})).data}async function Gi(e){let t,n=new Qn;for(;!e.isEmpty();){t=e.pop();let o=t.text,i=e.basePath+"/"+o;t.path=await dl(We.notebookId,i),t.path=e.pPath+"/"+t.path,n.push(t),t.children.isEmpty()||(t.children.basePath=i,t.children.pPath=t.path,Gi(t.children))}n.pPath=e.pPath}function ri({detail:e}){if(!hn&&(e.protyle.element.className.indexOf("search")!=-1||e.protyle.block.showAll))return;let t=e.protyle.notebookId,n=e.protyle.path,o=e.protyle.block.rootID;kr(t,n,o),vr(o)}class hl extends me.Plugin{async onload(){console.log("IndexPlugin onload"),this.init(),await ul(),await y.initData(),this.eventBus.on("click-blockicon",ai),this.eventBus.on("loaded-protyle-static",ri)}onunload(){this.eventBus.off("click-blockicon",ai),this.eventBus.off("loaded-protyle-static",ri),console.log("IndexPlugin onunload")}init(){mr(this.i18n),gr(this)}async openSetting(){await Wi()}}module.exports=hl;
