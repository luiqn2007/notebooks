import{d as u}from"./chunk.vendor_vite-plugin-node-polyfills.js";import{r as h}from"./chunk.vendor_elliptic.js";import{r as v}from"./chunk.vendor_bn-js.js";var a,y;function B(){if(y)return a;y=1;var o=h(),c=v();a=function(r){return new n(r)};var i={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};i.p224=i.secp224r1,i.p256=i.secp256r1=i.prime256v1,i.p192=i.secp192r1=i.prime192v1,i.p384=i.secp384r1,i.p521=i.secp521r1;function n(e){this.curveType=i[e],this.curveType||(this.curveType={name:e}),this.curve=new o.ec(this.curveType.name),this.keys=void 0}n.prototype.generateKeys=function(e,r){return this.keys=this.curve.genKeyPair(),this.getPublicKey(e,r)},n.prototype.computeSecret=function(e,r,t){r=r||"utf8",u.Buffer.isBuffer(e)||(e=new u.Buffer(e,r));var s=this.curve.keyFromPublic(e).getPublic(),f=s.mul(this.keys.getPrivate()).getX();return p(f,t,this.curveType.byteLength)},n.prototype.getPublicKey=function(e,r){var t=this.keys.getPublic(r==="compressed",!0);return r==="hybrid"&&(t[t.length-1]%2?t[0]=7:t[0]=6),p(t,e)},n.prototype.getPrivateKey=function(e){return p(this.keys.getPrivate(),e)},n.prototype.setPublicKey=function(e,r){return r=r||"utf8",u.Buffer.isBuffer(e)||(e=new u.Buffer(e,r)),this.keys._importPublic(e),this},n.prototype.setPrivateKey=function(e,r){r=r||"utf8",u.Buffer.isBuffer(e)||(e=new u.Buffer(e,r));var t=new c(e);return t=t.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(t),this};function p(e,r,t){Array.isArray(e)||(e=e.toArray());var s=new u.Buffer(e);if(t&&s.length<t){var f=new u.Buffer(t-s.length);f.fill(0),s=u.Buffer.concat([f,s])}return r?s.toString(r):s}return a}export{B as r};
