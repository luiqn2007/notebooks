{"ID":"20240311111510-ysxb5qd","Spec":"1","Type":"NodeDocument","Properties":{"icon":"2620-fe0f","id":"20240311111510-ysxb5qd","tags":"C++17","title":"构造函数冲突","updated":"20240311112037"},"Children":[{"ID":"20240311111510-yirbe46","Type":"NodeParagraph","Properties":{"id":"20240311111510-yirbe46","updated":"20240311112037"},"Children":[{"Type":"NodeTextMark","TextMarkType":"block-ref","TextMarkBlockRefID":"20240311111352-jfewm05","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"允许带有继承的类成为聚合类后"},{"Type":"NodeText","Data":"，由于聚合类的创建方式并非常规构造函数调用，可能产生一些问题。"}]},{"ID":"20240311111538-hus7cgl","Type":"NodeParagraph","Properties":{"id":"20240311111538-hus7cgl","updated":"20240311111600"},"Children":[{"Type":"NodeText","Data":"原本不是聚合类的类型变成了聚合类，但没有调用默认构造（通常由于隐式调用了基类保护构造）"}]},{"ID":"20240311111606-de3lb9w","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240311111606-de3lb9w","updated":"20240311111703"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yysr"},{"Type":"NodeCodeBlockCode","Data":"class A {\npublic:\n    int a;\n\nprotected:\n    A() = default;\n};\n\nclass B: public A {\n};\n\nint main() {\n    // error: 'constexpr A::A()' is protected within this context\n    B b {};\n    return 0;\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240311111631-4zu1lao","Type":"NodeSuperBlock","Properties":{"id":"20240311111631-4zu1lao","updated":"20240311111703"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"col"},{"ID":"20240311111606-yrw3oee","Type":"NodeParagraph","Properties":{"id":"20240311111606-yrw3oee","updated":"20240311111703"},"Children":[{"Type":"NodeText","Data":"C++17 之前，B 不是一个聚合类，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"B{}"},{"Type":"NodeText","Data":"​ 只是使用了 B 的默认构造，间接调用 A 默认构造在 B 类之内，可以访问到 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"protected"},{"Type":"NodeText","Data":"​ 成员"}]},{"ID":"20240311111606-jilhrcc","Type":"NodeParagraph","Properties":{"id":"20240311111606-jilhrcc","updated":"20240311111703"},"Children":[{"Type":"NodeText","Data":"C++17 及之后，B 是一个聚合类，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"B{}"},{"Type":"NodeText","Data":"​ 变成了一个聚合类型初始化，初始化时基类 A 被认为是 B 的一个简单成员，没有提供则使用默认值（查找无参构造），此时位置在 B 类之外，无法调用 A 的 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"protected"},{"Type":"NodeText","Data":"​ 成员"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"ID":"20240311111606-qip1l24","Type":"NodeParagraph","Properties":{"id":"20240311111606-qip1l24","updated":"20240311111606"},"Children":[{"Type":"NodeText","Data":"解决方案："}]},{"ID":"20240311111606-11azkdm","Type":"NodeList","ListData":{},"Properties":{"id":"20240311111606-11azkdm","updated":"20240311111606"},"Children":[{"ID":"20240311111606-9j942fi","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240311111606-9j942fi","updated":"20240311111606"},"Children":[{"ID":"20240311111606-f19ypb2","Type":"NodeParagraph","Properties":{"id":"20240311111606-f19ypb2","updated":"20240311111606"},"Children":[{"Type":"NodeText","Data":"使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"B b"},{"Type":"NodeText","Data":"​ 形式，隐式调用 B 的默认构造"}]}]},{"ID":"20240311111606-5kwcm6a","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240311111606-5kwcm6a","updated":"20240311111606"},"Children":[{"ID":"20240311111606-jy4g2lb","Type":"NodeParagraph","Properties":{"id":"20240311111606-jy4g2lb","updated":"20240311111606"},"Children":[{"Type":"NodeText","Data":"（C++20之前）使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"B b()"},{"Type":"NodeText","Data":"​ 形式"}]}]},{"ID":"20240311111606-g20qeb2","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240311111606-g20qeb2","updated":"20240311111606"},"Children":[{"ID":"20240311111606-ar1qmvw","Type":"NodeParagraph","Properties":{"id":"20240311111606-ar1qmvw","updated":"20240311111606"},"Children":[{"Type":"NodeText","Data":"为 B 声明自定义构造函数，使之不再是聚合类型"}]}]}]}]}