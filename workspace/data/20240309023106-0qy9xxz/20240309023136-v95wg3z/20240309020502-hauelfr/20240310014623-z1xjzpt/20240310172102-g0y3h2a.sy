{"ID":"20240310172102-g0y3h2a","Spec":"1","Type":"NodeDocument","Properties":{"icon":"2620-fe0f","id":"20240310172102-g0y3h2a","title":"assume","updated":"20240310220306"},"Children":[{"ID":"20240310172110-3t6se6w","Type":"NodeParagraph","Properties":{"id":"20240310172110-3t6se6w","updated":"20240310220306"},"Children":[{"Type":"NodeText","Data":"C++23 增加 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"[[assume(表达式)]]"},{"Type":"NodeText","Data":"​​ 被称为"},{"Type":"NodeTextMark","TextMarkType":"block-ref","TextMarkBlockRefID":"20240310014623-z1xjzpt","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"假定表达式"},{"Type":"NodeText","Data":"，告诉编译器表达式中的条件一定满足，可以放心做对应的，更激进的优化。这实际上在某些编译器上早有实现："}]},{"ID":"20240310172110-ybydlrf","Type":"NodeList","ListData":{},"Properties":{"id":"20240310172110-ybydlrf","updated":"20240310172110"},"Children":[{"ID":"20240310172110-3sfhj5g","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240310172110-3sfhj5g","updated":"20240310172110"},"Children":[{"ID":"20240310172110-0g7ihsr","Type":"NodeParagraph","Properties":{"id":"20240310172110-0g7ihsr","updated":"20240310172110"},"Children":[{"Type":"NodeText","Data":"CLang "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"__builtin_assume"},{"Type":"NodeText","Data":"​"}]}]},{"ID":"20240310172110-e5a64hr","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240310172110-e5a64hr","updated":"20240310172110"},"Children":[{"ID":"20240310172110-xmfesa8","Type":"NodeParagraph","Properties":{"id":"20240310172110-xmfesa8","updated":"20240310172110"},"Children":[{"Type":"NodeText","Data":"MSVC "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"__assume"},{"Type":"NodeText","Data":"​\n注意："}]}]},{"ID":"20240310172110-ndctgkh","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240310172110-ndctgkh","updated":"20240310172110"},"Children":[{"ID":"20240310172110-2aievrz","Type":"NodeParagraph","Properties":{"id":"20240310172110-2aievrz","updated":"20240310172110"},"Children":[{"Type":"NodeText","Data":"假定表达式不会做任何检查"}]}]},{"ID":"20240310172110-wom0hnj","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240310172110-wom0hnj","updated":"20240310172110"},"Children":[{"ID":"20240310172110-rxdeuw5","Type":"NodeParagraph","Properties":{"id":"20240310172110-rxdeuw5","updated":"20240310172110"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"[[assume()]]"},{"Type":"NodeText","Data":"​ 只能标记空语句（后直接接 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":";"},{"Type":"NodeText","Data":"​）"}]}]}]},{"ID":"20240310172110-4qn8x5p","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240310172110-4qn8x5p","updated":"20240310172110"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yysr"},{"Type":"NodeCodeBlockCode","Data":"void limiter(float* data, size_t size) {\n    // 优化：可一次并行处理 32 个非负元素\n    [[assume(size \u003e 0)]];\n    [[assume(size % 32 == 0)]];\n    for (size_t i = 0; i \u003c size; ++i)\n    {\n        [[assume(std::isfinite(data[i]))]];\n        data[i] = std::clamp(data[i], -1.0f, 1.0f);\n    }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}