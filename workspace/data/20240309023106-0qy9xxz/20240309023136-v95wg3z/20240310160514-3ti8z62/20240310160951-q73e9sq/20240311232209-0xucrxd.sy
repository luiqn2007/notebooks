{"ID":"20240311232209-0xucrxd","Spec":"1","Type":"NodeDocument","Properties":{"icon":"2620-fe0f","id":"20240311232209-0xucrxd","title":"实参推导","updated":"20240312000134"},"Children":[{"ID":"20240311232229-r6y0dul","Type":"NodeList","ListData":{},"Properties":{"id":"20240311232229-r6y0dul","updated":"20240311232251"},"Children":[{"ID":"20240311232229-008axoj","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240311232229-008axoj","updated":"20240311232251"},"Children":[{"ID":"20240311232229-be9a9rd","Type":"NodeParagraph","Properties":{"id":"20240311232229-be9a9rd","updated":"20240311232247"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"tag","TextMarkTextContent":"C++17"},{"Type":"NodeText","Data":"​ 之后，允许通过初始化构造推导"},{"Type":"NodeTextMark","TextMarkType":"block-ref","TextMarkBlockRefID":"20240310160951-q73e9sq","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"类模板"},{"Type":"NodeText","Data":"实参，但不允许部分推导"}]},{"ID":"20240311232229-fkfbk56","Type":"NodeList","ListData":{},"Properties":{"id":"20240311232229-fkfbk56","updated":"20240311232251"},"Children":[{"ID":"20240311232229-9x7vqlw","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240311232229-9x7vqlw","updated":"20240311232251"},"Children":[{"ID":"20240311232229-z0hu5h8","Type":"NodeParagraph","Properties":{"id":"20240311232229-z0hu5h8","updated":"20240311232251"},"Children":[{"Type":"NodeText","Data":"注意："},{"Type":"NodeTextMark","TextMarkType":"tag","TextMarkTextContent":"C++20"},{"Type":"NodeText","Data":"​ 规定，当拷贝初始化可以使用时，拷贝初始化优先"}]}]}]}]}]},{"ID":"20240311232642-21018v7","Type":"NodeSuperBlock","Properties":{"id":"20240311232642-21018v7","updated":"20240311232804"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"col"},{"ID":"20240311232229-n8c106n","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240311232229-n8c106n","style":"width: 50%; flex: 0 0 auto;","updated":"20240311232804"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yysr"},{"Type":"NodeCodeBlockCode","Data":"template\u003cclass F, class S\u003e\nstruct MyPair {\n    MyPair(F \u0026\u0026f, S \u0026\u0026s): \n          _f(std::move(f)), _s(std::move(s)) {\n    }\n\n    F _f;\n    S _s;\n};\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240311232634-15bflqx","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240311232634-15bflqx","style":"width: 47%; flex: 0 0 auto;","updated":"20240311232752"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yysr"},{"Type":"NodeCodeBlockCode","Data":"int main() {\n    // p: MyPair\u003cint, double\u003e\n    MyPair p {3, 5.0};\n    // error: wrong number of template arguments \n    // (1, should be 2)\n    MyPair\u003cint\u003e pp {3, 5.0};\n    return 0;\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"ID":"20240311232229-ra3aocg","Type":"NodeParagraph","Properties":{"id":"20240311232229-ra3aocg","updated":"20240311232303"},"Children":[{"Type":"NodeText","Data":"对于非类型（包括 "},{"Type":"NodeTextMark","TextMarkType":"code block-ref","TextMarkBlockRefID":"20240310155505-od3u1cu","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"auto"},{"Type":"NodeText","Data":"​）也可以进行推导"}]},{"ID":"20240311232229-u2kpr70","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240311232229-u2kpr70","updated":"20240311232229"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yysr"},{"Type":"NodeCodeBlockCode","Data":"template\u003cclass T, auto N\u003e\nstruct CountOf {\n    CountOf(T(\u0026)[N]) {}\n};\n\nint main() {\n    // c: CountOf\u003cchar, 7\u003e\n    CountOf c{\"string\"};\n    return 0;\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240311232229-3nr639j","Type":"NodeParagraph","Properties":{"id":"20240311232229-3nr639j","updated":"20240311232229"},"Children":[{"Type":"NodeText","Data":"该规则也可以用于简化 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"lambda"},{"Type":"NodeText","Data":"​ 表达式作为数据成员存储时的写法。"}]},{"ID":"20240311232346-n23q8fo","Type":"NodeSuperBlock","Properties":{"id":"20240311232346-n23q8fo","updated":"20240311232417"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"col"},{"ID":"20240311232342-23cnimp","Type":"NodeSuperBlock","Properties":{"id":"20240311232342-23cnimp","updated":"20240311232347"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"row"},{"ID":"20240311232327-cqhc7gx","Type":"NodeParagraph","Properties":{"id":"20240311232327-cqhc7gx","updated":"20240311232344"},"Children":[{"Type":"NodeText","Data":"C++17 前："}]},{"ID":"20240311232229-ot0i8jw","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240311232229-ot0i8jw","updated":"20240311232344"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yysr"},{"Type":"NodeCodeBlockCode","Data":"template\u003cclass T\u003e\nstruct LambdaWrap {\n    T func;\n    LambdaWrap(T t): func(t) {}\n\n    template\u003cclass ...Args\u003e\n    void operator()(Args\u0026\u0026 ...args) {\n        func(std::forward\u003cArgs\u003e(args)...);\n    }\n};\n\nint main() {\n    auto f = [](int a, float b) {\n        cout \u003c\u003c a \u003c\u003c ' ' \u003c\u003c b;\n    };\n    // 需要使用 decltype 推导 f 的类型\n    LambdaWrap\u003cdecltype(f)\u003e wrap(f);\n    wrap(1, 2.3f);\n    return 0;\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"ID":"20240311232334-ov5r565","Type":"NodeSuperBlock","Properties":{"id":"20240311232334-ov5r565","updated":"20240311232417"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"row"},{"ID":"20240311232229-sfc5vse","Type":"NodeParagraph","Properties":{"id":"20240311232229-sfc5vse","updated":"20240311232417"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"tag","TextMarkTextContent":"C++17"},{"Type":"NodeText","Data":"​ 后，可以省略 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"decltype"},{"Type":"NodeText","Data":"​："}]},{"ID":"20240311232229-uzzoung","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240311232229-uzzoung","updated":"20240311232335"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yysr"},{"Type":"NodeCodeBlockCode","Data":"int main() {\n    auto f = [](int a, float b) {\n        cout \u003c\u003c a \u003c\u003c ' ' \u003c\u003c b;\n    };\n    LambdaWrap wrap(f);\n    wrap(1, 2.3f);\n    return 0;\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"ID":"20240311232229-k6qqeze","Type":"NodeList","ListData":{},"Properties":{"id":"20240311232229-k6qqeze","updated":"20240311232434"},"Children":[{"ID":"20240311232229-bnnq6qi","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240311232229-bnnq6qi","updated":"20240311232434"},"Children":[{"ID":"20240311232229-dmlmaef","Type":"NodeParagraph","Properties":{"id":"20240311232229-dmlmaef","updated":"20240311232434"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"tag","TextMarkTextContent":"C++20"},{"Type":"NodeText","Data":"​ 后，支持别名模板的类模板实参推导"}]}]}]},{"ID":"20240311232229-lj53pwh","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240311232229-lj53pwh","updated":"20240311232229"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yysr"},{"Type":"NodeCodeBlockCode","Data":"template\u003cclass T, class U\u003e\nstruct C {\n    C(T, U) {}\n};\n\ntemplate\u003cclass V\u003e\nusing A = C\u003cV*, V*\u003e;\n\nint main() {\n    int i;\n    double d;\n\n    // 编译通过 T, U 类型均为 int*\n    A a1(\u0026i, \u0026i);\n    // 编译错误: int 无法匹配指针类型\n    // error: class template argument deduction failed\n    A a2(i, i);\n    // 编译错误: int*, double* 无法匹配 V*, V*\n    // error: class template argument deduction failed\n    A a3(\u0026i, \u0026d);\n    return 0;\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240311232229-nvtgnvw","Type":"NodeList","ListData":{},"Properties":{"id":"20240311232229-nvtgnvw","updated":"20240312000134"},"Children":[{"ID":"20240311232229-vztmrv6","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240311232229-vztmrv6","updated":"20240312000134"},"Children":[{"ID":"20240311232229-ri0qk0q","Type":"NodeParagraph","Properties":{"id":"20240311232229-ri0qk0q","updated":"20240312000134"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"tag","TextMarkTextContent":"C++20"},{"Type":"NodeText","Data":"​ 后，支持聚合类型的类模板实参推导"}]}]}]},{"ID":"20240311232229-lkrusjz","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240311232229-lkrusjz","updated":"20240311232229"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yysr"},{"Type":"NodeCodeBlockCode","Data":"template\u003cclass T\u003e\nstruct S {\n    T x;\n    T y;\n};\n\nint main() {\n    S {1, 2};\n    // 编译错误: x:int y:uint 无法匹配 x:T y:T\n    // error: class template argument deduction failed\n    S {1, 2u};\n    return 0;\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}