{"ID":"20240310163728-96imc0h","Spec":"1","Type":"NodeDocument","Properties":{"icon":"2620-fe0f","id":"20240310163728-96imc0h","title":"模板链接","updated":"20240310230001"},"Children":[{"ID":"20240310163735-r37uuvo","Type":"NodeParagraph","Properties":{"id":"20240310163735-r37uuvo","updated":"20240310163735"},"Children":[{"Type":"NodeText","Data":"通常情况下，我们将 C++ 代码分为头文件和源文件（dot-C 文件）两部分。"}]},{"ID":"20240310163735-6x80mtx","Type":"NodeList","ListData":{},"Properties":{"id":"20240310163735-6x80mtx","updated":"20240310163735"},"Children":[{"ID":"20240310163735-sb10j4h","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240310163735-sb10j4h","updated":"20240310163735"},"Children":[{"ID":"20240310163735-ep1hqmh","Type":"NodeParagraph","Properties":{"id":"20240310163735-ep1hqmh","updated":"20240310163735"},"Children":[{"Type":"NodeText","Data":"头文件扩展名常为 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":".h"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":".H"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":".hh"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":".hpp"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":".hxx"},{"Type":"NodeText","Data":"​ 等"}]}]},{"ID":"20240310163735-5ne4zrk","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240310163735-5ne4zrk","updated":"20240310163735"},"Children":[{"ID":"20240310163735-ho8xu45","Type":"NodeParagraph","Properties":{"id":"20240310163735-ho8xu45","updated":"20240310163735"},"Children":[{"Type":"NodeText","Data":"源文件扩展名常为 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":".cpp"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":".c"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":".C"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":".cc"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":".cxx"},{"Type":"NodeText","Data":"​ 等"}]}]}]},{"ID":"20240310163735-qdx5tb4","Type":"NodeParagraph","Properties":{"id":"20240310163735-qdx5tb4","updated":"20240310163735"},"Children":[{"Type":"NodeText","Data":"一般情况下，我们会将类、结构体等类型定义，全局变量，函数声明和内联函数实现放在头文件中，其他函数实现放在源文件中，并在源文件中引入对应头文件。这样定义对函数可见，且不会出现重复定义问题。"}]},{"ID":"20240310163735-6jhmgym","Type":"NodeParagraph","Properties":{"id":"20240310163735-6jhmgym","updated":"20240310225423"},"Children":[{"Type":"NodeText","Data":"但"},{"Type":"NodeTextMark","TextMarkType":"block-ref","TextMarkBlockRefID":"20240310160514-3ti8z62","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"模板"},{"Type":"NodeText","Data":"函数和模板类有所不同，当以如下形式定义在两个文件中时编译能通过（符号都能找到），但若在其他地方使用时，会导致链接失败，提示找不到 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"print_typeof"},{"Type":"NodeText","Data":"​ 函数。"}]},{"ID":"20240310163735-k9s2go1","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240310163735-k9s2go1","updated":"20240310163735"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yysr"},{"Type":"NodeCodeBlockCode","Data":"// h 文件\ntemplate \u003ctypename T\u003e  \nvoid print_typeof(T value);\n\n// cpp 文件\n#include \u003ciostream\u003e\n#include \"tmp.h\"\ntemplate\u003ctypename T\u003e\nvoid print_typeof(T value) {\n    std::cout \u003c\u003c typeid(value).name() \u003c\u003c std::endl;\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240310163735-5nsxh6u","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240310163735-5nsxh6u","updated":"20240310163735"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yysr"},{"Type":"NodeCodeBlockCode","Data":"// other cpp\n// 假设 print_typeof 函数在 \"print_typeof.h\" 头文件中定义\n#include \"print_typeof.h\"\n\nprint_typeof(10);\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240310163735-q1n3kv2","Type":"NodeParagraph","Properties":{"id":"20240310163735-q1n3kv2","updated":"20240310225500"},"Children":[{"Type":"NodeText","Data":"问题在于，"},{"Type":"NodeTextMark","TextMarkType":"block-ref","TextMarkBlockRefID":"20240309022839-gbty49q","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"链接器"},{"Type":"NodeText","Data":"从源代码中找到了 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"print_typeof"},{"Type":"NodeText","Data":"​​ 的定义头文件，但找不到其实现，链接器就无法将模板函数或模板类实例化成具体函数、具体类，这种模式称为模板的包含模型。而普通函数或类是不需要实例化这一步的。"}]},{"ID":"20240310163735-8h5n3zd","Type":"NodeParagraph","Properties":{"id":"20240310163735-8h5n3zd","updated":"20240310163735"},"Children":[{"Type":"NodeText","Data":"要解决这个问题有两种解决办法"}]},{"ID":"20240310163735-nwcecua","Type":"NodeList","ListData":{},"Properties":{"id":"20240310163735-nwcecua","updated":"20240310230001"},"Children":[{"ID":"20240310163735-ze4wtxz","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240310163735-ze4wtxz","updated":"20240310163735"},"Children":[{"ID":"20240310163735-yr1d8dt","Type":"NodeParagraph","Properties":{"id":"20240310163735-yr1d8dt","updated":"20240310163735"},"Children":[{"Type":"NodeText","Data":"将涉及模板的具体实现与头文件放在一起"}]}]},{"ID":"20240310163735-aeds4u4","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240310163735-aeds4u4","updated":"20240310225509"},"Children":[{"ID":"20240310163735-ddk5wte","Type":"NodeParagraph","Properties":{"id":"20240310163735-ddk5wte","updated":"20240310225509"},"Children":[{"Type":"NodeText","Data":"在能访问到的地方对使用到的类型实现"},{"Type":"NodeTextMark","TextMarkType":"block-ref","TextMarkBlockRefID":"20240310161115-blbt40a","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"模板特化"}]}]},{"ID":"20240310163735-tfreoh9","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240310163735-tfreoh9","updated":"20240310230001"},"Children":[{"ID":"20240310163735-ancoocl","Type":"NodeParagraph","Properties":{"id":"20240310163735-ancoocl","updated":"20240310230001"},"Children":[{"Type":"NodeText","Data":"使用"},{"Type":"NodeTextMark","TextMarkType":"block-ref","TextMarkBlockRefID":"20240310163759-zlf8egk","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"外部模板"},{"Type":"NodeText","Data":"，不建议且大概率无效"}]}]}]}]}