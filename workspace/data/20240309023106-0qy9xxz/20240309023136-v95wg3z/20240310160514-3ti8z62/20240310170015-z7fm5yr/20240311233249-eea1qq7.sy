{"ID":"20240311233249-eea1qq7","Spec":"1","Type":"NodeDocument","Properties":{"icon":"2620-fe0f","id":"20240311233249-eea1qq7","tags":"C++11","title":"替换失败","updated":"20240311233440"},"Children":[{"ID":"20240311233257-eal2irs","Type":"NodeParagraph","Properties":{"id":"20240311233257-eal2irs","updated":"20240311233333"},"Children":[{"Type":"NodeText","Data":"由于编译错误比替换失败更容易列举，这里只列举"},{"Type":"NodeTextMark","TextMarkType":"block-ref","TextMarkBlockRefID":"20240311233217-8auizoc","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"编译失败"},{"Type":"NodeText","Data":"的例子，除开编译失败外其他模板错误均为"},{"Type":"NodeTextMark","TextMarkType":"block-ref","TextMarkBlockRefID":"20240311233210-gusconq","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"替换失败"},{"Type":"NodeText","Data":"："}]},{"ID":"20240311233257-2gegevi","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20240311233257-2gegevi","updated":"20240311233257"},"Children":[{"ID":"20240311233257-tslwv7e","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20240311233257-tslwv7e","updated":"20240311233257"},"Children":[{"ID":"20240311233257-8fgr6t9","Type":"NodeParagraph","Properties":{"id":"20240311233257-8fgr6t9","updated":"20240311233257"},"Children":[{"Type":"NodeText","Data":"处理表达式外部某些实体时发生错误"}]}]}]},{"ID":"20240311233345-gwvr0g1","Type":"NodeSuperBlock","Properties":{"id":"20240311233345-gwvr0g1","updated":"20240311233402"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"col"},{"ID":"20240311233257-7915i48","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240311233257-7915i48","updated":"20240311233347"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yysr"},{"Type":"NodeCodeBlockCode","Data":"class bar {\npublic:\n    bar() {};\n    // error: expected ',' or '...' before '\u0026\u0026' token\n    // error: invalid constructor; you probably meant 'bar (const bar\u0026)'\n    bar(bar\u0026\u0026) {};\n};\n\ntemplate\u003cclass T\u003e\nT foo(T\u0026 t) {\n    T tt(t);\n    return t;\n}\n\nvoid foo(...) {\n}\n\nint main() {\n    bar b;\n    foo(b);\n    return 0;\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240311233400-ba2z0gp","Type":"NodeSuperBlock","Properties":{"id":"20240311233400-ba2z0gp","updated":"20240311233402"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"row"},{"ID":"20240311233257-asc380v","Type":"NodeParagraph","Properties":{"id":"20240311233257-asc380v","updated":"20240311233402"},"Children":[{"Type":"NodeText","Data":"这是编译错误。"}]},{"ID":"20240311233351-pjf113o","Type":"NodeParagraph","Properties":{"id":"20240311233351-pjf113o","updated":"20240311233402"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"foo"},{"Type":"NodeText","Data":"​ 在根据函数声明进行推断时，可以匹配 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"T foo(T\u0026amp;)"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"T"},{"Type":"NodeText","Data":"​ 推断为 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"bar"},{"Type":"NodeText","Data":"​。"}]},{"ID":"20240311233354-7zy3j1h","Type":"NodeParagraph","Properties":{"id":"20240311233354-7zy3j1h","updated":"20240311233402"},"Children":[{"Type":"NodeText","Data":"在执行到 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"foo"},{"Type":"NodeText","Data":"​ 函数中时，发现 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"T tt(t)"},{"Type":"NodeText","Data":"​ 一步无法生成复制构造，造成编译错误"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"ID":"20240311233257-icpj50t","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20240311233257-icpj50t","updated":"20240311233257"},"Children":[{"ID":"20240311233257-ptt759z","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20240311233257-ptt759z","updated":"20240311233257"},"Children":[{"ID":"20240311233257-apztvzh","Type":"NodeParagraph","Properties":{"id":"20240311233257-apztvzh","updated":"20240311233257"},"Children":[{"Type":"NodeText","Data":"由于实现受限导致错误：代码可能正确，但由于编译器实现上的限制造成了错误"}]}]},{"ID":"20240311233257-n3k3fh2","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20240311233257-n3k3fh2","updated":"20240311233257"},"Children":[{"ID":"20240311233257-tadu50v","Type":"NodeParagraph","Properties":{"id":"20240311233257-tadu50v","updated":"20240311233257"},"Children":[{"Type":"NodeText","Data":"访问违规"}]}]}]},{"ID":"20240311233421-r4mbm4j","Type":"NodeSuperBlock","Properties":{"id":"20240311233421-r4mbm4j","updated":"20240311233422"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"col"},{"ID":"20240311233257-fm8ylzq","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240311233257-fm8ylzq","updated":"20240311233422"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yysr"},{"Type":"NodeCodeBlockCode","Data":"class bar {\n    bar() {};\n};\n\ntemplate\u003cclass T\u003e\nT foo(T*) {\n    // error: 'bar::bar()' is private within this context\n    return T();\n}\n\nvoid foo(...) {\n}\n\nint main() {\n    foo(static_cast\u003cbar*\u003e(nullptr));\n    return 0;\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240311233418-p5b7ge7","Type":"NodeSuperBlock","Properties":{"id":"20240311233418-p5b7ge7","updated":"20240311233422"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"row"},{"ID":"20240311233257-2mp1f9q","Type":"NodeParagraph","Properties":{"id":"20240311233257-2mp1f9q","updated":"20240311233420"},"Children":[{"Type":"NodeText","Data":"编译错误。"}]},{"ID":"20240311233411-exkgjfw","Type":"NodeParagraph","Properties":{"id":"20240311233411-exkgjfw","updated":"20240311233420"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"foo"},{"Type":"NodeText","Data":"​ 在进行推断时，可匹配 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"T foo(T*)"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"T"},{"Type":"NodeText","Data":"​ 推断为 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"bar"},{"Type":"NodeText","Data":"​。"}]},{"ID":"20240311233413-7yof5jj","Type":"NodeParagraph","Properties":{"id":"20240311233413-7yof5jj","updated":"20240311233420"},"Children":[{"Type":"NodeText","Data":"在执行到 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"foo"},{"Type":"NodeText","Data":"​ 函数中时，发现 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"T()"},{"Type":"NodeText","Data":"​ 一步无法访问私有构造，造成编译错误"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"ID":"20240311233257-hysxd1w","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20240311233257-hysxd1w","updated":"20240311233257"},"Children":[{"ID":"20240311233257-k99jpqb","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"NC4=","Num":4},"Properties":{"id":"20240311233257-k99jpqb","updated":"20240311233257"},"Children":[{"ID":"20240311233257-q997a3m","Type":"NodeParagraph","Properties":{"id":"20240311233257-q997a3m","updated":"20240311233257"},"Children":[{"Type":"NodeText","Data":"由于同一个函数的不同声明的词法顺序不同，导致替换顺序不同或无法替换"}]}]}]},{"ID":"20240311233438-67a932z","Type":"NodeSuperBlock","Properties":{"id":"20240311233438-67a932z","updated":"20240311233440"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"col"},{"ID":"20240311233257-4f6f0qx","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240311233257-4f6f0qx","updated":"20240311233440"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yysr"},{"Type":"NodeCodeBlockCode","Data":"template\u003cclass T\u003e struct A { using X = typename T::X; };\ntemplate\u003cclass T\u003e T::X foo(typename A\u003cT\u003e::X);\ntemplate\u003cclass T\u003e void foo(...) {}\ntemplate\u003cclass T\u003e auto bar(typename A\u003cT\u003e::X) -\u003e T::X;\ntemplate\u003cclass T\u003e void bar(...);\n\nint main() {\n    foo\u003cint\u003e(0);\n    // error: 'int' is not a class, struct, or union type\n    bar\u003cint\u003e(0);\n    return 0;\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240311233434-y96fdoq","Type":"NodeSuperBlock","Properties":{"id":"20240311233434-y96fdoq","updated":"20240311233440"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"row"},{"ID":"20240311233257-colat4m","Type":"NodeParagraph","Properties":{"id":"20240311233257-colat4m","updated":"20240311233436"},"Children":[{"Type":"NodeText","Data":"第一个 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"foo\u0026lt;int\u0026gt;(0)"},{"Type":"NodeText","Data":"​ 编译通过。匹配 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"T::X foo(A\u0026lt;T\u0026gt;::X)"},{"Type":"NodeText","Data":"​ 时找不到 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"int::X"},{"Type":"NodeText","Data":"​，产生替换失败，可以正常匹配到 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"foo(...)"},{"Type":"NodeText","Data":"​。"}]},{"ID":"20240311233257-k4fgee7","Type":"NodeParagraph","Properties":{"id":"20240311233257-k4fgee7","updated":"20240311233436"},"Children":[{"Type":"NodeText","Data":"第二个 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"bar\u0026lt;int\u0026gt;(0)"},{"Type":"NodeText","Data":"​ 编译错误。在匹配 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"bar(A\u0026lt;T\u0026gt;::X)"},{"Type":"NodeText","Data":"​ 时，返回值后置，编译器由于 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"A\u0026lt;int\u0026gt;::T"},{"Type":"NodeText","Data":"​ 实例化了一个模板，此时不再是直接上下文环境，不会触发替换失败，直接发生编译错误。"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"Type":"NodeSuperBlockCloseMarker"}]}]}