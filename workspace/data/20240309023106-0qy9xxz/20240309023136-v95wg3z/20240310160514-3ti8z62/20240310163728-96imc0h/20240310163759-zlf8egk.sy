{"ID":"20240310163759-zlf8egk","Spec":"1","Type":"NodeDocument","Properties":{"icon":"2620-fe0f","id":"20240310163759-zlf8egk","tags":"C++11","title":"外部模板","updated":"20240311235231"},"Children":[{"ID":"20240310165927-4bdrygr","Type":"NodeParagraph","Properties":{"id":"20240310165927-4bdrygr","updated":"20240311235108"},"Children":[{"Type":"NodeText","Data":"外部模板，又称模板的分离模型，使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"export"},{"Type":"NodeText","Data":"​ 修饰模板的定义即可。"}]},{"ID":"20240310165927-f0c8jzp","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240310165927-f0c8jzp","updated":"20240310165927"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yysr"},{"Type":"NodeCodeBlockCode","Data":"export template \u003ctypename T\u003e  \nvoid print_typeof(T value);\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240310165927-0gt5mfp","Type":"NodeParagraph","Properties":{"id":"20240310165927-0gt5mfp","updated":"20240311235231"},"Children":[{"Type":"NodeText","Data":"该声明允许"},{"Type":"NodeTextMark","TextMarkType":"block-ref","TextMarkBlockRefID":"20240310160514-3ti8z62","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"模板"},{"Type":"NodeText","Data":"不在当前文件中实例化，可用于函数模板和类模板。但 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"export"},{"Type":"NodeText","Data":"​ 与 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"inline"},{"Type":"NodeText","Data":"​ 无法共存。"}]},{"ID":"20240311235139-lykg9ie","Type":"NodeSuperBlock","Properties":{"id":"20240311235139-lykg9ie","updated":"20240311235209"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"col"},{"ID":"20240311235135-gwarigd","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240311235135-gwarigd","updated":"20240311235141"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yysr"},{"Type":"NodeCodeBlockCode","Data":"// 模板定义的文件中，特化指定类型的模板函数\ntemplate\u003cclass T\u003e\nvoid foo() {\n    cout \u003c\u003c \"foo\u003cT\u003e\\n\";\n}\n\ntemplate\u003c\u003e\nvoid foo\u003cint\u003e() {\n    cout \u003c\u003c \"foo\u003cint\u003e\\n\";\n}\n\ntemplate\u003c\u003e\nvoid foo\u003cdouble\u003e() {\n    cout \u003c\u003c \"foo\u003cdouble\u003e\\n\";\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240311235135-alktc8m","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240311235135-alktc8m","updated":"20240311235209"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yysr"},{"Type":"NodeCodeBlockCode","Data":"// 模板实际使用位置\n// extern template 特化的模板声明;\nextern template void foo\u003cint\u003e();\nextern template void foo\u003cdouble\u003e();\n\nint main() {\n    // foo\u003cT\u003e\n    foo\u003cstring\u003e();\n    // foo\u003cint\u003e\n    foo\u003cint\u003e();\n    // foo\u003cdouble\u003e\n    foo\u003cdouble\u003e();\n    return 0;\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"ID":"20240311235215-h4fmypw","Type":"NodeParagraph","Properties":{"id":"20240311235215-h4fmypw","updated":"20240311235215"},"Children":[{"Type":"NodeText","Data":"如果不使用外部模板，C++ 编译器会在所有使用模板的文件中实例化对应模板。虽然最终链接器会对重复的模板进行去重操作，不影响编译的正确性，但在文件过多时，影响编译效率。"}]},{"ID":"20240310165927-fjtzkdq","Type":"NodeParagraph","Properties":{"id":"20240310165927-fjtzkdq","updated":"20240310165927"},"Children":[{"Type":"NodeText","Data":"事实上，分离模型实例化需要查找的两个位置 - 模板定义和实例化位置之间，编译器会在其中建立一些耦合，且对程序员不可见，这就会产生一些新问题"}]},{"ID":"20240310165927-ae4myzz","Type":"NodeList","ListData":{},"Properties":{"id":"20240310165927-ae4myzz","updated":"20240310165927"},"Children":[{"ID":"20240310165927-kbqr2sj","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240310165927-kbqr2sj","updated":"20240310165927"},"Children":[{"ID":"20240310165927-3qojgs6","Type":"NodeParagraph","Properties":{"id":"20240310165927-3qojgs6","updated":"20240310165927"},"Children":[{"Type":"NodeText","Data":"需要更多的编译时间"}]}]},{"ID":"20240310165927-vx43uyt","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240310165927-vx43uyt","updated":"20240310165927"},"Children":[{"ID":"20240310165927-55ncji1","Type":"NodeParagraph","Properties":{"id":"20240310165927-55ncji1","updated":"20240310165927"},"Children":[{"Type":"NodeText","Data":"make、nmake 等基于代码的依赖性管理工具失效"}]}]},{"ID":"20240310165927-10qwvb9","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240310165927-10qwvb9","updated":"20240310165927"},"Children":[{"ID":"20240310165927-z8yfggc","Type":"NodeParagraph","Properties":{"id":"20240310165927-z8yfggc","updated":"20240310165927"},"Children":[{"Type":"NodeText","Data":"可能会出现一些以外的语义"}]}]}]}]}