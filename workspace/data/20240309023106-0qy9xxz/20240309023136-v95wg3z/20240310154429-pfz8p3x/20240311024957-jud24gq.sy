{"ID":"20240311024957-jud24gq","Spec":"1","Type":"NodeDocument","Properties":{"icon":"2620-fe0f","id":"20240311024957-jud24gq","tags":"C++14","title":"广义捕获","updated":"20240311025121"},"Children":[{"ID":"20240311025007-7ocf5v4","Type":"NodeParagraph","Properties":{"id":"20240311025007-7ocf5v4","updated":"20240311025121"},"Children":[{"Type":"NodeText","Data":"C++14 定义了两种 "},{"Type":"NodeTextMark","TextMarkType":"block-ref","TextMarkBlockRefID":"20240310154429-pfz8p3x","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"lambda 表达式"},{"Type":"NodeText","Data":"的捕获方式 - 简单捕获和初始化捕获。"}]},{"ID":"20240311025007-gsv4i2f","Type":"NodeParagraph","Properties":{"id":"20240311025007-gsv4i2f","updated":"20240311025007"},"Children":[{"Type":"NodeText","Data":"简单捕获即前面的按值捕获和引用捕获。初始化捕获由 c++14 引入，在捕获中使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"="},{"Type":"NodeText","Data":"​ 初始化某个变量，解决了简单捕获无法捕获表达式结果和自定义捕获变量名的问题。"}]},{"ID":"20240311025007-008yeuo","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240311025007-008yeuo","updated":"20240311025007"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yysr"},{"Type":"NodeCodeBlockCode","Data":"int x = 5;\nauto foo = [r = x + 1] { return r; };\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240311025007-wwbvsc5","Type":"NodeParagraph","Properties":{"id":"20240311025007-wwbvsc5","updated":"20240311025007"},"Children":[{"Type":"NodeText","Data":"以上实例中，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"r"},{"Type":"NodeText","Data":"​ 作用域存在于 lambda 表达式中；"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"x"},{"Type":"NodeText","Data":"​ 作用域存在于上下文中，在 lambda 表达式中无法访问。广义捕获常用于："}]},{"ID":"20240311025007-9r10lup","Type":"NodeList","ListData":{},"Properties":{"id":"20240311025007-9r10lup","updated":"20240311025007"},"Children":[{"ID":"20240311025007-chlxpaw","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240311025007-chlxpaw","updated":"20240311025007"},"Children":[{"ID":"20240311025007-928dr5c","Type":"NodeParagraph","Properties":{"id":"20240311025007-928dr5c","updated":"20240311025007"},"Children":[{"Type":"NodeText","Data":"允许在捕获时使用移动构造"}]}]}]},{"ID":"20240311025007-pn47f2i","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240311025007-pn47f2i","updated":"20240311025007"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yysr"},{"Type":"NodeCodeBlockCode","Data":"string s;\nauto foo = [str = std::move(s)] { ... };\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240311025007-6w367p1","Type":"NodeList","ListData":{},"Properties":{"id":"20240311025007-6w367p1","updated":"20240311025007"},"Children":[{"ID":"20240311025007-l2uvvek","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240311025007-l2uvvek","updated":"20240311025007"},"Children":[{"ID":"20240311025007-6xw45nu","Type":"NodeParagraph","Properties":{"id":"20240311025007-6xw45nu","updated":"20240311025007"},"Children":[{"Type":"NodeText","Data":"传入 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"this"},{"Type":"NodeText","Data":"​ 对象的副本，防止 lambda 表达式调用时外部对象被析构造成的未定义行为"}]}]}]},{"ID":"20240311025007-e8izh3r","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240311025007-e8izh3r","updated":"20240311025007"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yysr"},{"Type":"NodeCodeBlockCode","Data":"class Work {\npublic:\n    void test() {\n        auto foo = [tmp = *this] { ... }\n    }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240311025007-mnxx0ti","Type":"NodeParagraph","Properties":{"id":"20240311025007-mnxx0ti","updated":"20240311025029"},"Children":[{"Type":"NodeText","Data":"在 "},{"Type":"NodeTextMark","TextMarkType":"tag","TextMarkTextContent":"C++17"},{"Type":"NodeText","Data":"​ 中，可以使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"*this"},{"Type":"NodeText","Data":"​ 捕获 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"this"},{"Type":"NodeText","Data":"​ 对象的副本，下面的实例与上面作用相同："}]},{"ID":"20240311025007-u8e8rwl","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240311025007-u8e8rwl","updated":"20240311025007"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yysr"},{"Type":"NodeCodeBlockCode","Data":"class Work {\npublic:\n    void test() {\n        auto foo = [*this] { ... }\n    }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240311025007-immli2c","Type":"NodeParagraph","Properties":{"id":"20240311025007-immli2c","updated":"20240311025037"},"Children":[{"Type":"NodeText","Data":"为了更容易区分 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"[=, *this]"},{"Type":"NodeText","Data":"​ 与 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"[=]"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"tag","TextMarkTextContent":"C++20"},{"Type":"NodeText","Data":"​ 允许使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"[=, this]"},{"Type":"NodeText","Data":"​ 的写法，该写法的效果与 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"[=]"},{"Type":"NodeText","Data":"​ 相同。"}]},{"ID":"20240311025007-u6aqqjj","Type":"NodeList","ListData":{},"Properties":{"id":"20240311025007-u6aqqjj","updated":"20240311025007"},"Children":[{"ID":"20240311025007-kmg7xri","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240311025007-kmg7xri","updated":"20240311025007"},"Children":[{"ID":"20240311025007-pw7fqtb","Type":"NodeParagraph","Properties":{"id":"20240311025007-pw7fqtb","updated":"20240311025007"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"[=, *this]"},{"Type":"NodeText","Data":"​：捕获 this 对象副本和其他所有值副本"}]}]},{"ID":"20240311025007-0wueh8p","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240311025007-0wueh8p","updated":"20240311025007"},"Children":[{"ID":"20240311025007-vj0fo9y","Type":"NodeParagraph","Properties":{"id":"20240311025007-vj0fo9y","updated":"20240311025007"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"[=, this]"},{"Type":"NodeText","Data":"​ / "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"[=]"},{"Type":"NodeText","Data":"​：捕获 this 指针和其他所有副本"}]}]}]},{"ID":"20240311025038-t4yu0rh","Type":"NodeParagraph","Properties":{"id":"20240311025038-t4yu0rh"}}]}