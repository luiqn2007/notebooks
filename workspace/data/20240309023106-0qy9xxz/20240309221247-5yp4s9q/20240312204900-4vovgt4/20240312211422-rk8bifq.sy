{"ID":"20240312211422-rk8bifq","Spec":"1","Type":"NodeDocument","Properties":{"icon":"1f921","id":"20240312211422-rk8bifq","title":"栈和栈帧","updated":"20240312235848"},"Children":[{"ID":"20240312211422-5afe1ac","Type":"NodeParagraph","Properties":{"id":"20240312211422-5afe1ac","updated":"20240312211722"},"Children":[{"Type":"NodeText","Data":"虚拟机设计和实现方式有两种指令集："},{"Type":"NodeTextMark","TextMarkType":"inline-memo","TextMarkInlineMemoContent":"Stack based","TextMarkTextContent":"基于栈"},{"Type":"NodeText","Data":"的"},{"Type":"NodeTextMark","TextMarkType":"inline-memo","TextMarkInlineMemoContent":"如 Hotspot JVM，.net CLR","TextMarkTextContent":"虚拟机"},{"Type":"NodeText","Data":"指令集和"},{"Type":"NodeTextMark","TextMarkType":"inline-memo","TextMarkInlineMemoContent":"Register based","TextMarkTextContent":"基于寄存器"},{"Type":"NodeText","Data":"的"},{"Type":"NodeTextMark","TextMarkType":"inline-memo","TextMarkInlineMemoContent":"如 LuaVM，DalvikVM","TextMarkTextContent":"虚拟机"},{"Type":"NodeText","Data":"指令集。"}]},{"ID":"20240312211654-kskzvl5","Type":"NodeParagraph","Properties":{"id":"20240312211654-kskzvl5","updated":"20240312211803"},"Children":[{"Type":"NodeText","Data":"基于栈的指令集移植性好、指令短、实现简单，但无法随机访问堆栈元素，需要频繁出入栈，不利于代码优化"}]},{"ID":"20240312235424-vcbppe3","Type":"NodeParagraph","Properties":{"id":"20240312235424-vcbppe3","updated":"20240312235847"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240312235424-rw4tzqd.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240312212045-z7s590c","Type":"NodeSuperBlock","Properties":{"id":"20240312212045-z7s590c","updated":"20240312212048"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"col"},{"ID":"20240312211930-0uaq2hj","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240312211930-0uaq2hj","updated":"20240312212046"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ=="},{"Type":"NodeCodeBlockCode","Data":"int add(int a, int b) {\n    return a + b;\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240312211945-fy0jv6z","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240312211945-fy0jv6z","updated":"20240312212048"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode","Data":"iload_1 // 入栈 a\niload_2 // 入栈 b\niadd    // 相加，结果入栈顶\nireturn // 返回栈顶元素\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"ID":"20240312211803-dqne9xr","Type":"NodeParagraph","Properties":{"id":"20240312211803-dqne9xr","updated":"20240312235839"},"Children":[{"Type":"NodeText","Data":"基于寄存器的指令集速度快，可以充分利用寄存器，但操作数需要显示指定，指令较长"}]},{"ID":"20240312235826-hhej0u8","Type":"NodeParagraph","Properties":{"id":"20240312235826-hhej0u8","updated":"20240312235843"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240312235826-ks4nd0a.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240312231935-zpb0qtl","Type":"NodeSuperBlock","Properties":{"id":"20240312231935-zpb0qtl","updated":"20240312232046"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"col"},{"ID":"20240312231421-8qd1e94","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240312231421-8qd1e94","updated":"20240312231936"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"bHVh"},{"Type":"NodeCodeBlockCode","Data":"local function add_func(a, b)\n    return a + b;\nend\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240312231601-ys0b1v8","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240312231601-ys0b1v8","updated":"20240312232046"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode","Data":"ADD     R2 R0 R1  ; R2 := R0 + R1\nMMBIN   R0 R1 R6  ; Lua 5.4 新增指令?\nRETURN1 R2        ; 返回 R2 寄存器\nRETURN0           ; 为防止分支漏 return\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"ID":"20240312235848-is6l99r","Type":"NodeParagraph","Properties":{"id":"20240312235848-is6l99r"}}]}