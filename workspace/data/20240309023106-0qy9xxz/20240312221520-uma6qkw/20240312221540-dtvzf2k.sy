{"ID":"20240312221540-dtvzf2k","Spec":"1","Type":"NodeDocument","Properties":{"icon":"1f47d","id":"20240312221540-dtvzf2k","title":"Windows 管理员权限","updated":"20240312221934"},"Children":[{"ID":"20240312221541-mk8t5n7","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240312221541-mk8t5n7","updated":"20240312221908"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cHl0aG9u"},{"Type":"NodeCodeBlockCode","Data":"from ctypes import windll\n\nshell32 = windll.shell32\n\ndef is_admin() -\u003e bool:\n    \"\"\"\n    检查是否为管理员权限\n    :return: 是否以管理员权限执行\n    \"\"\"\n    try:\n        return shell32.IsUserAnAdmin()\n    except:\n        return False\n\n\ndef require_admin():\n    \"\"\"\n    请求管理员权限\n    :return: None\n    \"\"\"\n    if not is_admin():\n        shell32.ShellExecuteW(None, 'runas', sys.executable, __file__, None, 1)\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}