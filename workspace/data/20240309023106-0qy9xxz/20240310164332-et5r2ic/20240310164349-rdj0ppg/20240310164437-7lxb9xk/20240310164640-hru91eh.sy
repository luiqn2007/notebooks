{"ID":"20240310164640-hru91eh","Spec":"1","Type":"NodeDocument","Properties":{"id":"20240310164640-hru91eh","title":"锁","updated":"20240310164644"},"Children":[{"ID":"20240310164644-9qmc6ho","Type":"NodeParagraph","Properties":{"id":"20240310164644-9qmc6ho","updated":"20240310164644"},"Children":[{"Type":"NodeText","Data":"锁配合互斥量使用，位于 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"std::lock"},{"Type":"NodeText","Data":"​ 。动态释放锁资源，防止线程由于编码失误导致无法释放锁，主要有 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"std::lock_guard"},{"Type":"NodeText","Data":"​ 和"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"std::unique_lock"},{"Type":"NodeText","Data":"​ 两种模式"}]},{"ID":"20240310164644-3yiu7si","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240310164644-3yiu7si","updated":"20240310164644"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yysr"},{"Type":"NodeCodeBlockCode","Data":"// ...\nauto func = [\u0026](const string\u0026 name, int k) {\n    unique_lock\u003cmutex\u003e lock(m);\n    // ...\n};\n// ...\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240310164644-nb19ta2","Type":"NodeParagraph","Properties":{"id":"20240310164644-nb19ta2","updated":"20240310164644"},"Children":[{"Type":"NodeText","Data":"仅将 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"m.lock();"},{"Type":"NodeText","Data":"​ 修改为 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"unique_lock\u0026lt;mutex\u0026gt; lock(m);"},{"Type":"NodeText","Data":"​，移除 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"m.unlock"},{"Type":"NodeText","Data":"​ 即可，线程会自动在执行完成后释放锁。"}]},{"ID":"20240310164644-fqinx79","Type":"NodeParagraph","Properties":{"id":"20240310164644-fqinx79","updated":"20240310164644"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"std::lock_guard"},{"Type":"NodeText","Data":"​ 更加轻量级，但 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"std::unique_lock"},{"Type":"NodeText","Data":"​有 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"unlock"},{"Type":"NodeText","Data":"​ 函数可用于手动释放锁。"}]}]}